(()=>{"use strict";class t{constructor(t,e,s,n,i,o){this._name=t.name,this._link=t.link,this._likes=t.likes,this._alternative=t.alternative,this._templateSelectors=e,this._handleCardClick=s,this._owner=t.owner._id,this._clientId=n,this._cardId=t._id,this._handleCallbackDeleteCardOpenPopup=i,this._handleCardLike=o}_getTemplate(t){return document.querySelector(t).content.querySelector(".places__place").cloneNode(!0)}generateCard(){return this._element=this._clientId===this._owner?this._getTemplate(this._templateSelectors.owner):this._getTemplate(this._templateSelectors.anoser),this._deleteIcon=this._element.querySelector(".places__delete-icon"),this._cardImage=this._element.querySelector(".places__image"),this._cardImage.src=this._link,this._cardImage.alt=this._alternative,this._element.querySelector(".places__depiction").textContent=this._name,this._likeCalculator=this._element.querySelector(".places__like-calculator"),this._likeCalculator.textContent=this._likes.length,this._likes.find((t=>t._id===this._clientId))&&this._element.querySelector(".places__heart").classList.add("places__heart_active"),this._setEventListeners(),this._element}_setEventListeners(){this._element.querySelector(".places__heart").addEventListener("click",(()=>{this._handleCardLike(this._likeCalculator,this._element,this._cardId)})),this._deleteIcon&&this._deleteIcon.addEventListener("click",(()=>{this._handleCallbackDeleteCardOpenPopup(this._cardId,this._element)})),this._cardImage.addEventListener("click",(()=>{this._handleCardClick(this._name,this._link)}))}}class e{constructor(t,e){this._config=t,this._form=e,this._inputList=Array.from(this._form.querySelectorAll(this._config.inputSelector)),this._buttonElement=this._form.querySelector(this._config.submitButtonSelector)}_hideInputError(t){this._errorElement=this._form.querySelector(`.${t.id}-error`),t.classList.remove(this._config.inputErrorClass),this._errorElement.classList.remove(this._config.errorClass),this._errorElement.textContent=""}_showInputError(t){this._errorElement=this._form.querySelector(`.${t.id}-error`),t.classList.add(this._config.inputErrorClass),this._errorElement.textContent=t.validationMessage,this._errorElement.classList.add(this._config.errorClass)}_checkInputValidity(t){t.validity.valid?this._hideInputError(t):this._showInputError(t)}_hasInvalidInput(){return this._inputList.some((t=>!t.validity.valid))}_disableSubmitButton(){this._buttonElement.classList.add(this._config.inactiveButtonClass),this._buttonElement.disabled=!0}_enableSubmitButton(){this._buttonElement.classList.remove(this._config.inactiveButtonClass),this._buttonElement.disabled=!1}_toggleButtonState(){this._hasInvalidInput()?this._disableSubmitButton():this._enableSubmitButton()}_setEventListeners(){this._inputList.forEach((t=>{t.addEventListener("input",(()=>{this._checkInputValidity(t),this._toggleButtonState()}))}))}resetValidation(){this._toggleButtonState(),this._inputList.forEach((t=>{this._hideInputError(t)}))}enableValidation(){this._setEventListeners()}}class s{constructor(t){this._popup=document.querySelector(t)}open(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=t=>{"Escape"===t.key&&this.close()};setEventListeners(){this._popup.addEventListener("mousedown",(t=>{t.target.classList.contains("popup_opened")&&this.close(),t.target.classList.contains("popup__close-button")&&this.close()}))}}class n extends s{constructor(t,e){super(t),this._handlerFormSubmit=e,this._popupForm=this._popup.querySelector(".popup__form"),this._inputList=this._popupForm.querySelectorAll(".popup__input"),this._loadingButton=this._popup.querySelector(".popup__button"),this._initialButtonTextContent=this._loadingButton.textContent}close(){super.close(),this._popupForm.reset()}loadingProc(t){this._loadingButton.textContent=t?"Сохранение...":this._initialButtonTextContent}setInputValues(t){this._inputList.forEach((e=>{e.value=t[e.name]}))}_getInputValues(){return this._formData={},this._inputList.forEach((t=>{this._formData[t.name]=t.value})),this._formData}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(t=>{t.preventDefault(),this._handlerFormSubmit(this._getInputValues()),this.close()}))}}const i=document.querySelector(".places"),o={owner:"#template-place-owner",anoser:"#template-place"},r=document.querySelector(".profile__edit-button"),a=(document.querySelector("#popup__profile-setting").querySelector("#profile-setting_close-button"),document.querySelector(".profile__avatar-button")),l=(document.querySelector(".popup__input_name"),document.querySelector(".profile__name")),h=(document.querySelector(".popup__input_description"),document.querySelector(".profile__description")),c=document.querySelector(".profile__image"),u=document.querySelector(".profile__add-button"),p=(document.querySelector("#popup__cards-setting").querySelector("#cards-setting_close-button"),document.querySelector(".popup__input_title"),document.querySelector(".popup__input_url"),document.querySelector(".popup-image"),new class{constructor(t){this.url=t.url,this.headers=t.headers}_handleResponseStatus(t){return t.ok?t.json():Promise.reject(`Произошла ошибка: ${t.status}`)}getUserInformation(){return fetch(`${this.url}/users/me`,{method:"GET",headers:{authorization:this.headers,"Content-Type":"application/json"}}).then((t=>this._handleResponseStatus(t)))}getInitialCards(){return fetch(`${this.url}/cards`,{method:"GET",headers:{authorization:this.headers,"Content-Type":"application/json"}}).then((t=>this._handleResponseStatus(t)))}updateUserInformation(t){return fetch(`${this.url}/users/me`,{method:"PATCH",headers:{authorization:this.headers,"Content-Type":"application/json"},body:JSON.stringify({name:t.name,about:t.about})}).then((t=>this._handleResponseStatus(t)))}handleAddCard(t){return fetch(`${this.url}/cards`,{method:"POST",headers:{authorization:this.headers,"Content-Type":"application/json"},body:JSON.stringify({name:t.name,link:t.link})}).then((t=>this._handleResponseStatus(t)))}handleDeleteCard(t){return fetch(`${this.url}/cards/${t}`,{method:"DELETE",headers:{authorization:this.headers,"Content-Type":"application/json"}}).then((t=>this._handleResponseStatus(t)))}handleLikeCard(t){return fetch(`${this.url}/cards/likes/${t}`,{method:"PUT",headers:{authorization:this.headers,"Content-Type":"application/json"}}).then((t=>this._handleResponseStatus(t)))}handleDisLikeCard(t){return fetch(`${this.url}/cards/likes/${t}`,{method:"DELETE",headers:{authorization:this.headers,"Content-Type":"application/json"}}).then((t=>this._handleResponseStatus(t)))}userAvatarUpdate(t){return fetch(`${this.url}/users/me/avatar`,{method:"PATCH",headers:{authorization:this.headers,"Content-Type":"application/json"},body:JSON.stringify({avatar:t.avatarImput})}).then((t=>this._handleResponseStatus(t)))}}({url:"https://mesto.nomoreparties.co/v1/cohort-60",headers:"50c7d53e-b526-44ca-b3ac-53bfa1ff2f46"})),_={},d=new class{constructor(t,e,s){this._name=t,this._description=e,this._avatarInput=s}getUserInfo(){return this._userInfo={},this._userInfo.name=this._name.textContent,this._userInfo.about=this._description.textContent,this._userInfo}setUserInfo(t){this._name.textContent=t.name,this._description.textContent=t.about,this._avatarInput.src=t.avatar}setUserAvatar(t){this._avatarInput.src=t.avatar}}(l,h,c);function m(t,e){L.open({name:t,link:e})}function f(t,e){I.open(t,e)}function g(t,e,s){const n=e.querySelector(".places__heart");n.classList.contains("places__heart_active")?p.handleDisLikeCard(s).then((e=>{t.textContent=`${e.likes.length}`,n.classList.remove("places__heart_active")})).catch((t=>console.log(t))):p.handleLikeCard(s).then((e=>{t.textContent=`${e.likes.length}`,n.classList.add("places__heart_active")}))}function v(e,s){return new t(e,o,m,s,f,g).generateCard()}Promise.all([p.getUserInformation(),p.getInitialCards()]).then((t=>{const e=t[0],s=t[1];d.setUserInfo(e),c.src=e.avatar,d.id=e._id;const n=s.map((t=>v(t,d.id)));E.renderItems(n)})).catch((t=>console.log(t)));const S=new n("#update-avatar",(function(t){S.loadingProc(!0),p.userAvatarUpdate(t).then((t=>{d.setUserAvatar(t)})).catch((t=>console.log(t))).finally((()=>{S.loadingProc(!1)}))})),y=new n("#popup__profile-setting",(function(t){y.loadingProc(!0),p.updateUserInformation(t).then((t=>{d.setUserInfo(t)})).catch((t=>console.log(t))).finally((()=>{y.loadingProc(!1)}))})),C=new n("#popup__cards-setting",(function(t){C.loadingProc(!0),p.handleAddCard(t).then((t=>E.renderItem(v(t,d.id)))).catch((t=>console.log(t))).finally((()=>{C.loadingProc(!1)}))})),E=new class{constructor(t,e){this._container=e,this._renderer=t}renderItems(t){t.reverse().forEach((t=>{this._renderer(t,this._container)}))}renderItem(t){this._renderer(t,this._container)}}((function(t,e){e.prepend(t)}),i),I=new class extends s{constructor(t,e){super(t),this._handlerFormSubmit=e,this._popupForm=this._popup.querySelector(".popup__form"),this._loadingButton=this._popup.querySelector(".popup__button"),this._initialButtonTextContent=this._loadingButton.textContent}loadingProc(t){this._loadingButton.textContent=t?"Сохранение...":this._initialButtonTextContent}open(t,e){this._card=e,this._cardId=t,super.open()}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(t=>{t.preventDefault(),this._handlerFormSubmit(this._cardId,this._card),this.close()}))}}("#delete-card",(function(t,e){I.loadingProc(!0),p.handleDeleteCard(t).then((()=>{e.remove()})).catch((t=>console.log(t))).finally((()=>{I.loadingProc(!1)}))})),L=new class extends s{constructor(t){super(t),this._popupImage=this._popup.querySelector(".popup-image__image"),this._captionPopupImage=this._popup.querySelector(".popup-image__caption")}open(t){super.open(),this._captionPopupImage.textContent=t.name,this._popupImage.src=t.link,this._popupImage.alt=`Изображение ${t.name}`}}(".popup-image");var b;a.addEventListener("click",(function(){S.open(),_["update-avatar-form"].resetValidation()})),r.addEventListener("click",(function(){y.open(),y.setInputValues(d.getUserInfo()),_["profile-setup-form"].resetValidation()})),u.addEventListener("click",(function(){C.open(),_["cards-setting-form"].resetValidation()})),b={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},Array.from(document.querySelectorAll(b.formSelector)).forEach((t=>{const s=new e(b,t),n=t.getAttribute("name");_[n]=s,s.enableValidation()})),S.setEventListeners(),y.setEventListeners(),C.setEventListeners(),I.setEventListeners(),L.setEventListeners()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixTQUFTLFdBRXZDb0ksRUFBVTlGLE9BQ1Y4RCxFQUFlLHNCQUFzQm5FLGlCQUN2QyxJQTNCMEIvQixFRDlLRCxDQUN2QitJLGFBQWMsZUFDZHZJLGNBQWUsZ0JBQ2ZFLHFCQUFzQixpQkFDdEJnQixvQkFBcUIseUJBQ3JCVixnQkFBaUIsMEJBQ2pCQyxXQUFZLHdCQ3lLS1osTUFBTUMsS0FBSzNCLFNBQVM0QixpQkFBaUJQLEVBQU8rSSxlQUNwRGpILFNBQVNrSCxJQUNoQixNQUFNQyxFQUFZLElBQUlsSixFQUFjQyxFQUFRZ0osR0FDdENFLEVBQVdGLEVBQVlHLGFBQWEsUUFDMUNqRCxFQUFlZ0QsR0FBWUQsRUFDM0JBLEVBQVVqSCxrQkFBa0IsSUEwQmhDOEYsRUFBWXBGLG9CQUVadUYsRUFBb0J2RixvQkFFcEJ3RixFQUFVeEYsb0JBRVZxRSxFQUFhckUsb0JBRWJtRSxFQUFlbkUsbUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm0uanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIGRhdGEsXHJcbiAgICB0ZW1wbGF0ZVNlbGVjdG9ycyxcclxuICAgIGhhbmRsZUNhcmRDbGljayxcclxuICAgIGNsaWVudElkLFxyXG4gICAgaGFuZGxlQ2FsbGJhY2tEZWxldGVDYXJkT3BlblBvcHVwLFxyXG4gICAgaGFuZGxlQ2FyZExpa2VcclxuICApIHtcclxuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xyXG4gICAgdGhpcy5fbGlrZXMgPSBkYXRhLmxpa2VzO1xyXG4gICAgdGhpcy5fYWx0ZXJuYXRpdmUgPSBkYXRhLmFsdGVybmF0aXZlO1xyXG4gICAgdGhpcy5fdGVtcGxhdGVTZWxlY3RvcnMgPSB0ZW1wbGF0ZVNlbGVjdG9ycztcclxuICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcclxuICAgIHRoaXMuX293bmVyID0gZGF0YS5vd25lci5faWQ7XHJcbiAgICB0aGlzLl9jbGllbnRJZCA9IGNsaWVudElkO1xyXG4gICAgdGhpcy5fY2FyZElkID0gZGF0YS5faWQ7XHJcbiAgICB0aGlzLl9oYW5kbGVDYWxsYmFja0RlbGV0ZUNhcmRPcGVuUG9wdXAgPSBoYW5kbGVDYWxsYmFja0RlbGV0ZUNhcmRPcGVuUG9wdXA7XHJcbiAgICB0aGlzLl9oYW5kbGVDYXJkTGlrZSA9IGhhbmRsZUNhcmRMaWtlO1xyXG4gIH1cclxuICAvLyDQoNCw0LfQvNC10YLQutCwINC60LDRgNGC0L7Rh9C60LhcclxuICBfZ2V0VGVtcGxhdGUodGVtcGxhdGUpIHtcclxuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGVtcGxhdGUpXHJcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGxhY2VzX19wbGFjZVwiKVxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG5cclxuICAgIHJldHVybiBjYXJkRWxlbWVudDtcclxuICB9XHJcblxyXG4gIGdlbmVyYXRlQ2FyZCgpIHtcclxuICAgIC8v0L/RgNC+0LLQtdGA0Y/QtdC8INC+0LHQu9Cw0LTQsNGC0LXQu9GPID0+INCx0LXRgNC10Lwg0YLQtdC80L/Qu9C10LnRglxyXG4gICAgdGhpcy5fZWxlbWVudCA9XHJcbiAgICAgIHRoaXMuX2NsaWVudElkID09PSB0aGlzLl9vd25lclxyXG4gICAgICAgID8gdGhpcy5fZ2V0VGVtcGxhdGUodGhpcy5fdGVtcGxhdGVTZWxlY3RvcnMub3duZXIpXHJcbiAgICAgICAgOiB0aGlzLl9nZXRUZW1wbGF0ZSh0aGlzLl90ZW1wbGF0ZVNlbGVjdG9ycy5hbm9zZXIpO1xyXG4gICAgdGhpcy5fZGVsZXRlSWNvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wbGFjZXNfX2RlbGV0ZS1pY29uXCIpO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBsYWNlc19faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcclxuICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSB0aGlzLl9hbHRlcm5hdGl2ZTtcclxuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wbGFjZXNfX2RlcGljdGlvblwiKS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcblxyXG4gICAgdGhpcy5fbGlrZUNhbGN1bGF0b3IgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiLnBsYWNlc19fbGlrZS1jYWxjdWxhdG9yXCJcclxuICAgICk7XHJcbiAgICB0aGlzLl9saWtlQ2FsY3VsYXRvci50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcclxuXHJcbiAgICBpZiAodGhpcy5fbGlrZXMuZmluZCgobGlrZSkgPT4gbGlrZS5faWQgPT09IHRoaXMuX2NsaWVudElkKSkge1xyXG4gICAgICB0aGlzLl9lbGVtZW50XHJcbiAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIucGxhY2VzX19oZWFydFwiKVxyXG4gICAgICAgIC5jbGFzc0xpc3QuYWRkKFwicGxhY2VzX19oZWFydF9hY3RpdmVcIik7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fZWxlbWVudCAvLyDQodGC0LDQstC40Lwg0LvQsNC50LpcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIucGxhY2VzX19oZWFydFwiKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9oYW5kbGVDYXJkTGlrZSh0aGlzLl9saWtlQ2FsY3VsYXRvciwgdGhpcy5fZWxlbWVudCwgdGhpcy5fY2FyZElkKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgaWYgKHRoaXMuX2RlbGV0ZUljb24pIHsgLy8g0KPQtNCw0LvRj9C10Lwg0LrQsNGA0YLQvtGH0LrRg1xyXG4gICAgICB0aGlzLl9kZWxldGVJY29uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlQ2FsbGJhY2tEZWxldGVDYXJkT3BlblBvcHVwKHRoaXMuX2NhcmRJZCwgdGhpcy5fZWxlbWVudCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgdGhpcy5fY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7IC8vINCf0YDQvtGB0LzQvtGC0YAg0LrQsNGA0YLQuNC90LrQuCDRgSDQutCw0YDRgtC+0YfQutC4XHJcbiAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayh0aGlzLl9uYW1lLCB0aGlzLl9saW5rKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IHsgQ2FyZCB9O1xyXG4iLCJjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3IoY29uZmlnLCBmb3JtKSB7XG4gICAgdGhpcy5fY29uZmlnID0gY29uZmlnO1xuICAgIHRoaXMuX2Zvcm0gPSBmb3JtO1xuICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20oXG4gICAgICB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fY29uZmlnLmlucHV0U2VsZWN0b3IpIC8v0J/QvtC70YPRh9Cw0LXQvCDQuNC90L/Rg9GC0YtcbiAgICApO1xuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICB0aGlzLl9jb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3JcbiAgICApO1xuICB9XG5cbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgIHRoaXMuX2Vycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2NvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xuICAgIHRoaXMuX2Vycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2NvbmZpZy5lcnJvckNsYXNzKTtcbiAgICB0aGlzLl9lcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xuICB9XG5cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgIHRoaXMuX2Vycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2NvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xuICAgIHRoaXMuX2Vycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZTtcbiAgICB0aGlzLl9lcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9jb25maWcuZXJyb3JDbGFzcyk7XG4gIH1cblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xuICAgIGlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZFxuICAgICAgPyB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpXG4gICAgICA6IHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gIH1cblxuICBfaGFzSW52YWxpZElucHV0KCkge1xuICAgIHJldHVybiB0aGlzLl9pbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKTtcbiAgfVxuXG4gIF9kaXNhYmxlU3VibWl0QnV0dG9uKCkge1xuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9jb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7IC8vINCi0LjQvyDQutC90L7Qv9C60Lgo0YHQvtGF0YDQsNC90LjRjyDQv9C+0L/QsNC/0LApINCy0YvQutC70Y7Rh9C10L3QvdCwXG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XG4gIH1cblxuICBfZW5hYmxlU3VibWl0QnV0dG9uKCkge1xuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9jb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xuICB9XG5cbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xuICAgIHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpXG4gICAgICA/IHRoaXMuX2Rpc2FibGVTdWJtaXRCdXR0b24oKVxuICAgICAgOiB0aGlzLl9lbmFibGVTdWJtaXRCdXR0b24oKTtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgfSk7XG4gIH1cblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cbn1cblxuZXhwb3J0IHsgRm9ybVZhbGlkYXRvciB9O1xuIiwiY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgdGhpcy5fcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICB9XG4gIG9wZW4oKSB7XG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZChcInBvcHVwX29wZW5lZFwiKTsgLy8g0L7RgtC60YDRi9GC0Ywg0L/QvtC/0LDQv1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuZWRcIik7IC8vINCX0LDQutGA0YvRgtGMINC/0L7Qv9Cw0L9cbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBfaGFuZGxlRXNjQ2xvc2UgPSAoZXZ0KSA9PiB7XG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH07XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZXZ0KSA9PiB7XG4gICAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cF9vcGVuZWRcIikpIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfVxuICAgICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBfX2Nsb3NlLWJ1dHRvblwiKSkge1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cbmV4cG9ydCB7IFBvcHVwIH07XG4iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5jbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZXJGb3JtU3VibWl0KSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2hhbmRsZXJGb3JtU3VibWl0ID0gaGFuZGxlckZvcm1TdWJtaXQ7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtXCIpO1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIucG9wdXBfX2lucHV0XCIpO1xyXG4gICAgdGhpcy5fbG9hZGluZ0J1dHRvbiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2J1dHRvblwiKTtcclxuICAgIHRoaXMuX2luaXRpYWxCdXR0b25UZXh0Q29udGVudCA9IHRoaXMuX2xvYWRpbmdCdXR0b24udGV4dENvbnRlbnQ7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcclxuICB9XHJcblxyXG4gIGxvYWRpbmdQcm9jKHZhbHVlKSB7XHJcbiAgICBpZiAodmFsdWUpIHtcclxuICAgICAgdGhpcy5fbG9hZGluZ0J1dHRvbi50ZXh0Q29udGVudCA9IFwi0KHQvtGF0YDQsNC90LXQvdC40LUuLi5cIjtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2xvYWRpbmdCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9pbml0aWFsQnV0dG9uVGV4dENvbnRlbnQ7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRJbnB1dFZhbHVlcyhkYXRhKSB7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgLy8g0YLRg9GCINCy0YHRgtCw0LLQu9GP0LXQvCDQsiBgdmFsdWVgINC40L3Qv9GD0YLQsCDQtNCw0L3QvdGL0LUg0LjQtyDQvtCx0YrQtdC60YLQsCDQv9C+INCw0YLRgNC40LHRg9GC0YMgYG5hbWVgINGN0YLQvtCz0L4g0LjQvdC/0YPRgtCwXHJcbiAgICAgIGlucHV0LnZhbHVlID0gZGF0YVtpbnB1dC5uYW1lXTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgdGhpcy5fZm9ybURhdGEgPSB7fTtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICB0aGlzLl9mb3JtRGF0YVtpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gdGhpcy5fZm9ybURhdGE7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZlbnQpID0+IHtcclxuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5faGFuZGxlckZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IHsgUG9wdXBXaXRoRm9ybSB9O1xyXG4iLCJjb25zdCB2YWxpZGF0aW9uQ29uZmlnID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIucG9wdXBfX2Zvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5wb3B1cF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIucG9wdXBfX2J1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwicG9wdXBfX2J1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJwb3B1cF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwicG9wdXBfX2Vycm9yX3Zpc2libGVcIixcclxufTtcclxuXHJcbi8qINCh0JXQmtCm0JjQryDQotCV0JzQn9Cb0JXQmdCiICjQmtCQ0KDQotCe0KfQmtCYKSAqL1xyXG5jb25zdCBwbGFjZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBsYWNlc1wiKTsgLy8g0LHQu9C+0Log0LIgaHRtbCDQtNC70Y8g0LrQsNGA0YLQvtGH0LrQuFxyXG5jb25zdCB0ZW1wbGF0ZVNlbGVjdG9ycyA9IHtcclxuICBvd25lcjogXCIjdGVtcGxhdGUtcGxhY2Utb3duZXJcIixcclxuICBhbm9zZXI6IFwiI3RlbXBsYXRlLXBsYWNlXCIsXHJcbn07XHJcblxyXG4vKiDQn9Ce0J/QkNCfINCg0JXQlNCQ0JrQotCY0KDQntCS0JDQndCY0JUg0J/QoNCe0KTQmNCb0K8gKi9cclxuY29uc3QgcHJvZmlsZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIik7IC8vINC60L3QvtC/0LrQsCDRgNC10LTQsNC60YLQuNGA0L7QstCw0L3QuNC1INC/0YDQvtGE0LjQu9GB0Y9cclxuY29uc3QgcG9wdXBQcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwb3B1cF9fcHJvZmlsZS1zZXR0aW5nXCIpOyAvLyDRgdC10LrRhtC40Y8g0L/QvtC/0LDQv1xyXG5jb25zdCBjbG9zZUJ1dHRvblBvcHVwUHJvZmlsZSA9IHBvcHVwUHJvZmlsZS5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiI3Byb2ZpbGUtc2V0dGluZ19jbG9zZS1idXR0b25cIlxyXG4pO1xyXG5jb25zdCBhdmF0YXJCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhci1idXR0b25cIik7XHJcbi8vINC60L3QvtC/0LrQsCDQt9Cw0LrRgNGL0YLQuNGPINC/0L7Qv9Cw0L9cclxuLy9jb25zdCBmb3JtRWxQcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLXNldHRpbmdfX2Zvcm1cIik7IC8v0YTQvtGA0LzQsCDQuNC90L/Rg9GC0L7QslxyXG5jb25zdCBuYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbnB1dF9uYW1lXCIpOyAvLyDQuNC90L/Rg9GCINGBINC40LzQtdC90LXQvFxyXG5jb25zdCBwcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmFtZVwiKTsgLy8g0LjQvNGPINC/0YDQvtGE0LjQu9GPXHJcbmNvbnN0IGRlc2NyaXB0aW9uSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbnB1dF9kZXNjcmlwdGlvblwiKTsgLy8g0LjQvdC/0YPRgiDRgSDQvtC/0LjRgdCw0L3QuNC10LxcclxuY29uc3QgZGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpOyAvLyDQvtC/0LjRgdCw0L3QuNC1INC/0YDQvtGE0LjQu9GB0Y9cclxuY29uc3QgYXZhdGFySW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2ltYWdlXCIpO1xyXG4vKiDQoNCV0JTQkNCa0KLQmNCg0J7QktCQ0J3QmNCVINCf0KDQntCk0JjQm9CvICovXHJcblxyXG4vKiDQn9Ce0J/QkNCfINCU0J7QkdCQ0JLQm9CV0J3QmNCvINCa0JDQoNCi0J7Qp9Ca0JggKi9cclxuY29uc3QgY2FyZHNBZGRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7IC8vINC60L3QvtC/0LrQsCDRgNC10LTQsNC60YLQuNGA0L7QstCw0L3QuNC1INC60LDRgNGC0L7Rh9C10LpcclxuY29uc3QgcG9wdXBDYXJkcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcG9wdXBfX2NhcmRzLXNldHRpbmdcIik7IC8vINGB0LXQutGG0LjRjyDQv9C+0L/QsNC/INGBINC60LDRgNGC0L7Rh9C60LDQvNC4XHJcbmNvbnN0IGNsb3NlQnV0dG9uQ2FyZHMgPSBwb3B1cENhcmRzLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIjY2FyZHMtc2V0dGluZ19jbG9zZS1idXR0b25cIlxyXG4pOyAvLyDQutC90L7Qv9C60LAg0LfQsNC60YDRi9GC0LjRjyDQv9C+0L/QsNC/XHJcbi8vY29uc3QgZm9ybUVsQ2FyZHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmRzLXNldHRpbmdfX2Zvcm1cIik7IC8v0YTQvtGA0LzQsCDQuNC90L/Rg9GC0L7QslxyXG5jb25zdCB0aXRsZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW5wdXRfdGl0bGVcIik7IC8vINC40L3Qv9GD0YIg0YEg0L3QsNC30LLQsNC90LjQtdC8XHJcbmNvbnN0IHVybElucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW5wdXRfdXJsXCIpOyAvLyDQuNC90L/Rg9GCINGBINGB0YHRi9C70LrQvtC5XHJcbi8qINCf0J7Qn9CQ0J8g0JTQntCR0JDQktCb0JXQndCY0K8g0JrQkNCg0KLQntCn0JrQmCAqL1xyXG5cclxuY29uc3QgYXBpQ29uZmlnID0ge1xyXG4gIHVybDogXCJodHRwczovL21lc3RvLm5vbW9yZXBhcnRpZXMuY28vdjEvY29ob3J0LTYwXCIsXHJcbiAgaGVhZGVyczogXCI1MGM3ZDUzZS1iNTI2LTQ0Y2EtYjNhYy01M2JmYTFmZjJmNDZcIixcclxufTtcclxuXHJcbi8qINCf0J7Qn9CQ0J8g0J/QoNCe0KHQnNCe0KLQoNCQINCa0JDQoNCi0J7Qp9Ca0JggKi9cclxuY29uc3QgcG9wdXBJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXAtaW1hZ2VcIik7IC8vINC/0L7Qv9Cw0L8g0YEg0LrQsNGA0YLQuNC90LrQvtC5XHJcblxyXG5leHBvcnQge1xyXG4gIHRlbXBsYXRlU2VsZWN0b3JzLFxyXG4gIHZhbGlkYXRpb25Db25maWcsXHJcbiAgcGxhY2VzLFxyXG4gIHByb2ZpbGVCdXR0b24sXHJcbiAgcG9wdXBQcm9maWxlLFxyXG4gIG5hbWVJbnB1dCxcclxuICBwcm9maWxlTmFtZSxcclxuICBkZXNjcmlwdGlvbklucHV0LFxyXG4gIGRlc2NyaXB0aW9uLFxyXG4gIGNhcmRzQWRkQnV0dG9uLFxyXG4gIHBvcHVwQ2FyZHMsXHJcbiAgdGl0bGVJbnB1dCxcclxuICB1cmxJbnB1dCxcclxuICBwb3B1cEltYWdlLFxyXG4gIGNsb3NlQnV0dG9uUG9wdXBQcm9maWxlLFxyXG4gIGNsb3NlQnV0dG9uQ2FyZHMsXHJcbiAgYXBpQ29uZmlnLFxyXG4gIGF2YXRhckltYWdlLFxyXG4gIGF2YXRhckJ1dHRvbixcclxufTtcclxuIiwiaW1wb3J0IHsgQ2FyZCB9IGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IHsgRm9ybVZhbGlkYXRvciB9IGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IHsgU2VjdGlvbiB9IGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IHsgUG9wdXBXaXRoSW1hZ2UgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgeyBQb3B1cFdpdGhGb3JtIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoQ29uZmlybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtLmpzXCI7XHJcbmltcG9ydCB7IFVzZXJJbmZvIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IHtcclxuICB0ZW1wbGF0ZVNlbGVjdG9ycyxcclxuICB2YWxpZGF0aW9uQ29uZmlnLFxyXG4gIHBsYWNlcyxcclxuICBwcm9maWxlQnV0dG9uLFxyXG4gIG5hbWVJbnB1dCxcclxuICBwcm9maWxlTmFtZSxcclxuICBkZXNjcmlwdGlvbklucHV0LFxyXG4gIGRlc2NyaXB0aW9uLFxyXG4gIGNhcmRzQWRkQnV0dG9uLFxyXG4gIHRpdGxlSW5wdXQsXHJcbiAgdXJsSW5wdXQsXHJcbiAgYXBpQ29uZmlnLFxyXG4gIGF2YXRhckltYWdlLFxyXG4gIGF2YXRhckJ1dHRvbixcclxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XHJcbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcblxyXG4vLyDQmtC70LDRgdGBIEFwaVxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKGFwaUNvbmZpZyk7XHJcblxyXG4vLyDQpNC+0YDQvNGLINCy0LDQu9C40LTQsNGG0LjQuFxyXG5jb25zdCBmb3JtVmFsaWRhdG9ycyA9IHt9O1xyXG5cclxuLy8g0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GMXHJcbmNvbnN0IGNsaWVudCA9IG5ldyBVc2VySW5mbyhwcm9maWxlTmFtZSwgZGVzY3JpcHRpb24sIGF2YXRhckltYWdlKTtcclxuXHJcbi8vINC+0YLQutGA0YvRgtGMINC/0L7Qv9Cw0L8g0YEg0LrQsNGA0YLQuNC90LrQvtC5XHJcbmZ1bmN0aW9uIGhhbmRsZUNhcmRDbGljayhuYW1lLCBsaW5rKSB7XHJcbiAgcG9wdXBXaXRoSW1hZ2Uub3Blbih7IG5hbWUsIGxpbmsgfSk7XHJcbn1cclxuXHJcbi8v0LrQvtC70LHRjdC6INC+0YLQutGA0YvRgtC40Y8g0L/QvtC/0LDQv9CwINGD0LTQsNC70LXQvdC40Y8g0LrQsNGA0YLQvtGH0LrQuFxyXG5mdW5jdGlvbiBoYW5kbGVDYWxsYmFja0RlbGV0ZUNhcmRPcGVuUG9wdXAoY2FyZElkLCBjYXJkKSB7XHJcbiAgcG9wdXBDb25maXJtLm9wZW4oY2FyZElkLCBjYXJkKTtcclxufVxyXG4vL9C60L7Qu9Cx0Y3QuiDRg9C00LDQu9C10L3QuNGPINC60LDRgNGC0L7Rh9C60LhcclxuZnVuY3Rpb24gaGFuZGxlQ2FsbGJhY2tEZWxldGVDYXJkKGNhcmRJZCwgY2FyZCkge1xyXG4gIHBvcHVwQ29uZmlybS5sb2FkaW5nUHJvYyh0cnVlKTtcclxuICBhcGlcclxuICAgIC5oYW5kbGVEZWxldGVDYXJkKGNhcmRJZClcclxuICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgY2FyZC5yZW1vdmUoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgcG9wdXBDb25maXJtLmxvYWRpbmdQcm9jKGZhbHNlKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG4vL9GE0YPQvdC60YbQuNGPINC00LvRjyBTZWN0aW9uXHJcbmZ1bmN0aW9uIHJlbmRlcmVyKGVsZW1lbnQsIGNvbnRhaW5lcikge1xyXG4gIGNvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xyXG59XHJcblxyXG4vLyDQmtC+0LvQsdGN0Log0YHQvtC30LTQsNC90LjQtSDQutCw0YDRgtC+0YfQutC4XHJcbmZ1bmN0aW9uIGhhbmRsZUNhbGxiYWNrQ2FyZChjYXJkKSB7XHJcbiAgcG9wdXBDYXJkLmxvYWRpbmdQcm9jKHRydWUpO1xyXG4gIGFwaVxyXG4gICAgLmhhbmRsZUFkZENhcmQoY2FyZClcclxuICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgIHJldHVybiBzZWN0aW9uLnJlbmRlckl0ZW0oY3JlYXRlQ2FyZChkYXRhLCBjbGllbnQuaWQpKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgcG9wdXBDYXJkLmxvYWRpbmdQcm9jKGZhbHNlKTtcclxuICAgIH0pO1xyXG59XHJcbi8vINCa0L7Qu9Cx0Y3QuiDQu9Cw0LnQutCwINC60LDRgNGC0L7Rh9C60LhcclxuZnVuY3Rpb24gaGFuZGxlQ2FyZExpa2UoY291bnRlciwgY2FyZCwgY2FyZElkKSB7XHJcbiAgY29uc3QgaGVhcnRCdXR0b24gPSBjYXJkLnF1ZXJ5U2VsZWN0b3IoXCIucGxhY2VzX19oZWFydFwiKTtcclxuICBpZiAoIWhlYXJ0QnV0dG9uLmNsYXNzTGlzdC5jb250YWlucyhcInBsYWNlc19faGVhcnRfYWN0aXZlXCIpKSB7XHJcbiAgICBhcGkuaGFuZGxlTGlrZUNhcmQoY2FyZElkKS50aGVuKChyZXMpID0+IHtcclxuICAgICAgY291bnRlci50ZXh0Q29udGVudCA9IGAke3Jlcy5saWtlcy5sZW5ndGh9YDtcclxuICAgICAgaGVhcnRCdXR0b24uY2xhc3NMaXN0LmFkZChcInBsYWNlc19faGVhcnRfYWN0aXZlXCIpO1xyXG4gICAgfSk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGFwaVxyXG4gICAgICAuaGFuZGxlRGlzTGlrZUNhcmQoY2FyZElkKVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgY291bnRlci50ZXh0Q29udGVudCA9IGAke3Jlcy5saWtlcy5sZW5ndGh9YDtcclxuICAgICAgICBoZWFydEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwicGxhY2VzX19oZWFydF9hY3RpdmVcIik7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKTtcclxuICB9XHJcbn1cclxuXHJcbi8vINGB0L7Qt9C00LDRkdC8INC60LDRgNGC0L7Rh9C60YNcclxuZnVuY3Rpb24gY3JlYXRlQ2FyZChvYmplY3QsIGNsaWVudElkKSB7XHJcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxyXG4gICAgb2JqZWN0LFxyXG4gICAgdGVtcGxhdGVTZWxlY3RvcnMsXHJcbiAgICBoYW5kbGVDYXJkQ2xpY2ssXHJcbiAgICBjbGllbnRJZCxcclxuICAgIGhhbmRsZUNhbGxiYWNrRGVsZXRlQ2FyZE9wZW5Qb3B1cCxcclxuICAgIGhhbmRsZUNhcmRMaWtlXHJcbiAgKTtcclxuICByZXR1cm4gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcclxufVxyXG5cclxuLy8g0JrQu9Cw0YHRgSDQv9C+0L/QsNC/INC/0YDQvtGE0LjQu9GPLCDRjtC30LXRgNCwID0+XHJcbmZ1bmN0aW9uIGhhbmRsZUNhbGxiYWNrUHJvZmlsZShvYmplY3QpIHtcclxuICBwb3B1cFByb2ZpbGVTZXR0aW5nLmxvYWRpbmdQcm9jKHRydWUpO1xyXG4gIGFwaVxyXG4gICAgLnVwZGF0ZVVzZXJJbmZvcm1hdGlvbihvYmplY3QpXHJcbiAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICBjbGllbnQuc2V0VXNlckluZm8oZGF0YSk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHBvcHVwUHJvZmlsZVNldHRpbmcubG9hZGluZ1Byb2MoZmFsc2UpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8v0LTQsNC90L3Ri9C1INC/0YDQvtGE0LjQu9GPICwg0LrQsNGA0YLQvtGH0LrQuFxyXG5Qcm9taXNlLmFsbChbYXBpLmdldFVzZXJJbmZvcm1hdGlvbigpLCBhcGkuZ2V0SW5pdGlhbENhcmRzKCldKVxyXG4gIC50aGVuKChyZXMpID0+IHtcclxuICAgIGNvbnN0IHVzZXJJbmZvID0gcmVzWzBdO1xyXG4gICAgY29uc3QgaW5pdGlhbENhcmRzID0gcmVzWzFdO1xyXG5cclxuICAgIGNsaWVudC5zZXRVc2VySW5mbyh1c2VySW5mbyk7XHJcbiAgICBhdmF0YXJJbWFnZS5zcmMgPSB1c2VySW5mby5hdmF0YXI7XHJcbiAgICBjbGllbnQuaWQgPSB1c2VySW5mby5faWQ7XHJcblxyXG4gICAgY29uc3QgZGVmYXVsdENhcmRMaXN0ID0gaW5pdGlhbENhcmRzLm1hcCgoZGF0YSkgPT4ge1xyXG4gICAgICByZXR1cm4gY3JlYXRlQ2FyZChkYXRhLCBjbGllbnQuaWQpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgc2VjdGlvbi5yZW5kZXJJdGVtcyhkZWZhdWx0Q2FyZExpc3QpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpO1xyXG4vL1xyXG5mdW5jdGlvbiBoYW5kbGVDYWxsYmFja0F2YXRhcih2YWx1ZXMpIHtcclxuICBwb3B1cEF2YXRhci5sb2FkaW5nUHJvYyh0cnVlKTtcclxuICBhcGlcclxuICAgIC51c2VyQXZhdGFyVXBkYXRlKHZhbHVlcylcclxuICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgIGNsaWVudC5zZXRVc2VyQXZhdGFyKGRhdGEpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBwb3B1cEF2YXRhci5sb2FkaW5nUHJvYyhmYWxzZSk7XHJcbiAgICB9KTtcclxufVxyXG4vLyDQutC70LDRgdGBINC/0L7Qv9Cw0L8g0LDQstCw0YLQsNGAXHJcbmNvbnN0IHBvcHVwQXZhdGFyID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjdXBkYXRlLWF2YXRhclwiLCBoYW5kbGVDYWxsYmFja0F2YXRhcik7XHJcbi8vINC60LvQsNGB0YEg0L/QvtC/0LDQvyDQv9GA0L7RhNC40LvRjyA9PlxyXG5jb25zdCBwb3B1cFByb2ZpbGVTZXR0aW5nID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgXCIjcG9wdXBfX3Byb2ZpbGUtc2V0dGluZ1wiLFxyXG4gIGhhbmRsZUNhbGxiYWNrUHJvZmlsZVxyXG4pO1xyXG4vLyDQmtC70LDRgdGBINC/0L7Qv9Cw0L8g0LrQsNGA0YLQvtGH0LrQuCA9PlxyXG5jb25zdCBwb3B1cENhcmQgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcIiNwb3B1cF9fY2FyZHMtc2V0dGluZ1wiLFxyXG4gIGhhbmRsZUNhbGxiYWNrQ2FyZFxyXG4pO1xyXG4vLyDQmtC70LDRgdGBIFNlY3Rpb24gID0+XHJcbmNvbnN0IHNlY3Rpb24gPSBuZXcgU2VjdGlvbihyZW5kZXJlciwgcGxhY2VzKTtcclxuLy/QutC70LDRgdGBINC/0L7Qv9Cw0L8g0YHQvtCz0LvQsNGB0LjRjyDQvdCwINGD0LTQsNC70LXQvdC40Y9cclxuY29uc3QgcG9wdXBDb25maXJtID0gbmV3IFBvcHVwV2l0aENvbmZpcm0oXHJcbiAgXCIjZGVsZXRlLWNhcmRcIixcclxuICBoYW5kbGVDYWxsYmFja0RlbGV0ZUNhcmRcclxuKTtcclxuLy8g0JrQu9Cw0YHRgSBwb3B1cFdpdGhJbWFnZSAgPT5cclxuY29uc3QgcG9wdXBXaXRoSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIucG9wdXAtaW1hZ2VcIik7XHJcblxyXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpKTtcclxuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xyXG4gICAgY29uc3QgdmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCBmb3JtRWxlbWVudCk7XHJcbiAgICBjb25zdCBmb3JtTmFtZSA9IGZvcm1FbGVtZW50LmdldEF0dHJpYnV0ZShcIm5hbWVcIik7XHJcbiAgICBmb3JtVmFsaWRhdG9yc1tmb3JtTmFtZV0gPSB2YWxpZGF0b3I7XHJcbiAgICB2YWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuYXZhdGFyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgLy/QvtGC0LrRgNGL0YLQuNC1INC/0L7Qv9Cw0L/QsCDQv9C+INC90LDQttCw0YLQuNGOINC90LAg0LrQvdC+0L/QutGDINCe0LHQvdC+0LLQu9C10L3QuNC1INCw0LLQsNGC0LDRgNCwXHJcbiAgcG9wdXBBdmF0YXIub3BlbigpO1xyXG4gIGZvcm1WYWxpZGF0b3JzW1widXBkYXRlLWF2YXRhci1mb3JtXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xyXG59KTtcclxuXHJcbnByb2ZpbGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICAvLyDQvtGC0LrRgNGL0YLQuNC1INC/0L7Qv9Cw0L/QsCDQv9C+INC90LDQttCw0YLQuNGOINC90LAg0LrQvdC+0L/QutGDINC/0YDQvtGE0LjQu9GPXHJcbiAgcG9wdXBQcm9maWxlU2V0dGluZy5vcGVuKCk7XHJcbiAgcG9wdXBQcm9maWxlU2V0dGluZy5zZXRJbnB1dFZhbHVlcyhjbGllbnQuZ2V0VXNlckluZm8oKSk7XHJcbiAgZm9ybVZhbGlkYXRvcnNbXCJwcm9maWxlLXNldHVwLWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbn0pO1xyXG5cclxuY2FyZHNBZGRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICAvL9C+0YLQutGA0YvRgtC40LUg0L/QvtC/0LDQv9CwINC/0L4g0L3QsNC20LDRgtC40Y4g0L3QsCDQutC90L7Qv9C60YMg0LTQvtCx0LDQstC70LXQvdC40LUg0LrQsNGA0YLQvtGH0LrQuFxyXG4gIHBvcHVwQ2FyZC5vcGVuKCk7XHJcbiAgZm9ybVZhbGlkYXRvcnNbXCJjYXJkcy1zZXR0aW5nLWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbn0pO1xyXG5cclxuLy8g0JLQutC70Y7Rh9C10L3QuNC1INCy0LDQu9C40LTQsNGG0LjQuCA9PlxyXG5lbmFibGVWYWxpZGF0aW9uKHZhbGlkYXRpb25Db25maWcpO1xyXG4vLyBL0LvQsNGB0YEg0L/QvtC/0LDQvyDQsNCy0LDRgtCw0YAgPT5cclxucG9wdXBBdmF0YXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuLy8g0LrQu9Cw0YHRgSDQv9C+0L/QsNC/INC/0YDQvtGE0LjQu9GPID0+XHJcbnBvcHVwUHJvZmlsZVNldHRpbmcuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuLy8g0JrQu9Cw0YHRgSDQv9C+0L/QsNC/INC60LDRgNGC0L7Rh9C60LggPT5cclxucG9wdXBDYXJkLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbi8v0LrQu9Cw0YHRgSDQv9C+0L/QsNC/INGB0L7Qs9C70LDRgdC40Y8g0L3QsCDRg9C00LDQu9C10L3QuNGPID0+XHJcbnBvcHVwQ29uZmlybS5zZXRFdmVudExpc3RlbmVycygpO1xyXG4vLyDQmtC70LDRgdGBIHBvcHVwV2l0aEltYWdlICA9PlxyXG5wb3B1cFdpdGhJbWFnZS5zZXRFdmVudExpc3RlbmVycygpO1xyXG4vKlxyXG5cclxuKi9cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgYXBpIHtcclxuICBjb25zdHJ1Y3Rvcihjb25maWcpIHtcclxuICAgIHRoaXMudXJsID0gY29uZmlnLnVybDtcclxuICAgIHRoaXMuaGVhZGVycyA9IGNvbmZpZy5oZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZVJlc3BvbnNlU3RhdHVzKHJlcykge1xyXG4gICAgcmV0dXJuIHJlcy5va1xyXG4gICAgICA/IHJlcy5qc29uKClcclxuICAgICAgOiBQcm9taXNlLnJlamVjdChg0J/RgNC+0LjQt9C+0YjQu9CwINC+0YjQuNCx0LrQsDogJHtyZXMuc3RhdHVzfWApO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm9ybWF0aW9uKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMudXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkdFVFwiLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5oZWFkZXJzLFxyXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICB9LFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9oYW5kbGVSZXNwb25zZVN0YXR1cyhyZXMpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy51cmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLmhlYWRlcnMsXHJcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgIH0sXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgcmV0dXJuIHRoaXMuX2hhbmRsZVJlc3BvbnNlU3RhdHVzKHJlcyk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZVVzZXJJbmZvcm1hdGlvbih1c2VySW5mbykge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMudXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLmhlYWRlcnMsXHJcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgIH0sXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiB1c2VySW5mby5uYW1lLFxyXG4gICAgICAgIGFib3V0OiB1c2VySW5mby5hYm91dCxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgcmV0dXJuIHRoaXMuX2hhbmRsZVJlc3BvbnNlU3RhdHVzKHJlcyk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGhhbmRsZUFkZENhcmQoY2FyZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMudXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuaGVhZGVycyxcclxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICAgICAgfSxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IGNhcmQubmFtZSxcclxuICAgICAgICBsaW5rOiBjYXJkLmxpbmssXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9oYW5kbGVSZXNwb25zZVN0YXR1cyhyZXMpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBoYW5kbGVEZWxldGVDYXJkKGNhcmQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLnVybH0vY2FyZHMvJHtjYXJkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5oZWFkZXJzLFxyXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICB9LFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9oYW5kbGVSZXNwb25zZVN0YXR1cyhyZXMpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBoYW5kbGVMaWtlQ2FyZChpZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMudXJsfS9jYXJkcy9saWtlcy8ke2lkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5oZWFkZXJzLFxyXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICB9LFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9oYW5kbGVSZXNwb25zZVN0YXR1cyhyZXMpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBoYW5kbGVEaXNMaWtlQ2FyZChpZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMudXJsfS9jYXJkcy9saWtlcy8ke2lkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5oZWFkZXJzLFxyXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICB9LFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9oYW5kbGVSZXNwb25zZVN0YXR1cyhyZXMpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICB1c2VyQXZhdGFyVXBkYXRlKHVzZXJJbmZvKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy51cmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLmhlYWRlcnMsXHJcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgIH0sXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBhdmF0YXI6IHVzZXJJbmZvLmF2YXRhckltcHV0LFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICByZXR1cm4gdGhpcy5faGFuZGxlUmVzcG9uc2VTdGF0dXMocmVzKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IobmFtZUlucHV0LCBkZXNjcmlwdGlvbklucHV0LCBhdmF0YXJJbnB1dCkge1xyXG4gICAgdGhpcy5fbmFtZSA9IG5hbWVJbnB1dDtcclxuICAgIHRoaXMuX2Rlc2NyaXB0aW9uID0gZGVzY3JpcHRpb25JbnB1dDtcclxuICAgIHRoaXMuX2F2YXRhcklucHV0ID0gYXZhdGFySW5wdXQ7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHRoaXMuX3VzZXJJbmZvID0ge307XHJcbiAgICB0aGlzLl91c2VySW5mby5uYW1lID0gdGhpcy5fbmFtZS50ZXh0Q29udGVudDtcclxuICAgIHRoaXMuX3VzZXJJbmZvLmFib3V0ID0gdGhpcy5fZGVzY3JpcHRpb24udGV4dENvbnRlbnQ7XHJcbiAgICByZXR1cm4gdGhpcy5fdXNlckluZm87XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyhkYXRhKSB7XHJcbiAgICB0aGlzLl9uYW1lLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fZGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBkYXRhLmFib3V0O1xyXG4gICAgdGhpcy5fYXZhdGFySW5wdXQuc3JjID0gZGF0YS5hdmF0YXI7XHJcbiAgfVxyXG5cclxuICBzZXRVc2VyQXZhdGFyKGRhdGEpIHtcclxuICAgIHRoaXMuX2F2YXRhcklucHV0LnNyYyA9IGRhdGEuYXZhdGFyO1xyXG4gIH1cclxufVxyXG5leHBvcnQgeyBVc2VySW5mbyB9O1xyXG4iLCJjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3RvcihyZW5kZXJlciwgY29udGFpbmVyKSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIgPSBjb250YWluZXI7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMob2JqZWN0KSB7XHJcbiAgICBvYmplY3QucmV2ZXJzZSgpLmZvckVhY2goKGVsZW1lbnQpID0+IHtcclxuICAgICAgdGhpcy5fcmVuZGVyZXIoZWxlbWVudCwgdGhpcy5fY29udGFpbmVyKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9yZW5kZXJlcihlbGVtZW50LCB0aGlzLl9jb250YWluZXIpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IHsgU2VjdGlvbiB9O1xyXG4iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL1BvcHVwXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhDb25maXJtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZXJGb3JtU3VibWl0KSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2hhbmRsZXJGb3JtU3VibWl0ID0gaGFuZGxlckZvcm1TdWJtaXQ7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtXCIpO1xyXG4gICAgdGhpcy5fbG9hZGluZ0J1dHRvbiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2J1dHRvblwiKTtcclxuICAgIHRoaXMuX2luaXRpYWxCdXR0b25UZXh0Q29udGVudCA9IHRoaXMuX2xvYWRpbmdCdXR0b24udGV4dENvbnRlbnQ7XHJcbiAgfVxyXG5cclxuICBsb2FkaW5nUHJvYyh2YWx1ZSkge1xyXG4gICAgaWYgKHZhbHVlKSB7XHJcbiAgICAgIHRoaXMuX2xvYWRpbmdCdXR0b24udGV4dENvbnRlbnQgPSBcItCh0L7RhdGA0LDQvdC10L3QuNC1Li4uXCI7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9sb2FkaW5nQnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5faW5pdGlhbEJ1dHRvblRleHRDb250ZW50O1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgb3BlbihjYXJkSWQsIGNhcmQpIHtcclxuICAgIHRoaXMuX2NhcmQgPSBjYXJkO1xyXG4gICAgdGhpcy5fY2FyZElkID0gY2FyZElkO1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2ZW50KSA9PiB7XHJcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZXJGb3JtU3VibWl0KHRoaXMuX2NhcmRJZCwgdGhpcy5fY2FyZCk7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fcG9wdXBJbWFnZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXAtaW1hZ2VfX2ltYWdlXCIpOyAvL9C60LDRgNGC0LjQvdC60LAg0L/QvtC/0LDQv9CwXG4gICAgdGhpcy5fY2FwdGlvblBvcHVwSW1hZ2UgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFxuICAgICAgLy8g0J7Qv9C40YHQsNC90LjQtSDQutCw0YDRgtC40L3QutC4XG4gICAgICBcIi5wb3B1cC1pbWFnZV9fY2FwdGlvblwiXG4gICAgKTtcbiAgfVxuXG4gIG9wZW4oaW1hZ2UpIHtcbiAgICBzdXBlci5vcGVuKCk7XG4gICAgdGhpcy5fY2FwdGlvblBvcHVwSW1hZ2UudGV4dENvbnRlbnQgPSBpbWFnZS5uYW1lO1xuICAgIHRoaXMuX3BvcHVwSW1hZ2Uuc3JjID0gaW1hZ2UubGluaztcbiAgICB0aGlzLl9wb3B1cEltYWdlLmFsdCA9IGDQmNC30L7QsdGA0LDQttC10L3QuNC1ICR7aW1hZ2UubmFtZX1gO1xuICB9XG59XG5cbmV4cG9ydCB7IFBvcHVwV2l0aEltYWdlIH07XG4iXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwiZGF0YSIsInRlbXBsYXRlU2VsZWN0b3JzIiwiaGFuZGxlQ2FyZENsaWNrIiwiY2xpZW50SWQiLCJoYW5kbGVDYWxsYmFja0RlbGV0ZUNhcmRPcGVuUG9wdXAiLCJoYW5kbGVDYXJkTGlrZSIsInRoaXMiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfbGlrZXMiLCJsaWtlcyIsIl9hbHRlcm5hdGl2ZSIsImFsdGVybmF0aXZlIiwiX3RlbXBsYXRlU2VsZWN0b3JzIiwiX2hhbmRsZUNhcmRDbGljayIsIl9vd25lciIsIm93bmVyIiwiX2lkIiwiX2NsaWVudElkIiwiX2NhcmRJZCIsIl9oYW5kbGVDYWxsYmFja0RlbGV0ZUNhcmRPcGVuUG9wdXAiLCJfaGFuZGxlQ2FyZExpa2UiLCJfZ2V0VGVtcGxhdGUiLCJ0ZW1wbGF0ZSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJnZW5lcmF0ZUNhcmQiLCJfZWxlbWVudCIsImFub3NlciIsIl9kZWxldGVJY29uIiwiX2NhcmRJbWFnZSIsInNyYyIsImFsdCIsInRleHRDb250ZW50IiwiX2xpa2VDYWxjdWxhdG9yIiwibGVuZ3RoIiwiZmluZCIsImxpa2UiLCJjbGFzc0xpc3QiLCJhZGQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJhZGRFdmVudExpc3RlbmVyIiwiRm9ybVZhbGlkYXRvciIsImNvbmZpZyIsImZvcm0iLCJfY29uZmlnIiwiX2Zvcm0iLCJfaW5wdXRMaXN0IiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0U2VsZWN0b3IiLCJfYnV0dG9uRWxlbWVudCIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2hpZGVJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiX2Vycm9yRWxlbWVudCIsImlkIiwicmVtb3ZlIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9zaG93SW5wdXRFcnJvciIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGFzSW52YWxpZElucHV0Iiwic29tZSIsIl9kaXNhYmxlU3VibWl0QnV0dG9uIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImRpc2FibGVkIiwiX2VuYWJsZVN1Ym1pdEJ1dHRvbiIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImZvckVhY2giLCJyZXNldFZhbGlkYXRpb24iLCJlbmFibGVWYWxpZGF0aW9uIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwIiwib3BlbiIsIl9oYW5kbGVFc2NDbG9zZSIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImV2dCIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlckZvcm1TdWJtaXQiLCJzdXBlciIsIl9oYW5kbGVyRm9ybVN1Ym1pdCIsIl9wb3B1cEZvcm0iLCJfbG9hZGluZ0J1dHRvbiIsIl9pbml0aWFsQnV0dG9uVGV4dENvbnRlbnQiLCJyZXNldCIsImxvYWRpbmdQcm9jIiwidmFsdWUiLCJzZXRJbnB1dFZhbHVlcyIsImlucHV0IiwiX2dldElucHV0VmFsdWVzIiwiX2Zvcm1EYXRhIiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsInBsYWNlcyIsInByb2ZpbGVCdXR0b24iLCJhdmF0YXJCdXR0b24iLCJwcm9maWxlTmFtZSIsImRlc2NyaXB0aW9uIiwiYXZhdGFySW1hZ2UiLCJjYXJkc0FkZEJ1dHRvbiIsImFwaSIsInVybCIsImhlYWRlcnMiLCJfaGFuZGxlUmVzcG9uc2VTdGF0dXMiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0VXNlckluZm9ybWF0aW9uIiwiZmV0Y2giLCJtZXRob2QiLCJhdXRob3JpemF0aW9uIiwidGhlbiIsImdldEluaXRpYWxDYXJkcyIsInVwZGF0ZVVzZXJJbmZvcm1hdGlvbiIsInVzZXJJbmZvIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhYm91dCIsImhhbmRsZUFkZENhcmQiLCJjYXJkIiwiaGFuZGxlRGVsZXRlQ2FyZCIsImhhbmRsZUxpa2VDYXJkIiwiaGFuZGxlRGlzTGlrZUNhcmQiLCJ1c2VyQXZhdGFyVXBkYXRlIiwiYXZhdGFyIiwiYXZhdGFySW1wdXQiLCJmb3JtVmFsaWRhdG9ycyIsImNsaWVudCIsIm5hbWVJbnB1dCIsImRlc2NyaXB0aW9uSW5wdXQiLCJhdmF0YXJJbnB1dCIsIl9kZXNjcmlwdGlvbiIsIl9hdmF0YXJJbnB1dCIsImdldFVzZXJJbmZvIiwiX3VzZXJJbmZvIiwic2V0VXNlckluZm8iLCJzZXRVc2VyQXZhdGFyIiwicG9wdXBXaXRoSW1hZ2UiLCJjYXJkSWQiLCJwb3B1cENvbmZpcm0iLCJjb3VudGVyIiwiaGVhcnRCdXR0b24iLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJjcmVhdGVDYXJkIiwib2JqZWN0IiwiYWxsIiwiaW5pdGlhbENhcmRzIiwiZGVmYXVsdENhcmRMaXN0IiwibWFwIiwic2VjdGlvbiIsInJlbmRlckl0ZW1zIiwicG9wdXBBdmF0YXIiLCJ2YWx1ZXMiLCJmaW5hbGx5IiwicG9wdXBQcm9maWxlU2V0dGluZyIsInBvcHVwQ2FyZCIsInJlbmRlckl0ZW0iLCJyZW5kZXJlciIsImNvbnRhaW5lciIsIl9jb250YWluZXIiLCJfcmVuZGVyZXIiLCJyZXZlcnNlIiwiZWxlbWVudCIsInByZXBlbmQiLCJfY2FyZCIsIl9wb3B1cEltYWdlIiwiX2NhcHRpb25Qb3B1cEltYWdlIiwiaW1hZ2UiLCJmb3JtU2VsZWN0b3IiLCJmb3JtRWxlbWVudCIsInZhbGlkYXRvciIsImZvcm1OYW1lIiwiZ2V0QXR0cmlidXRlIl0sInNvdXJjZVJvb3QiOiIifQ==