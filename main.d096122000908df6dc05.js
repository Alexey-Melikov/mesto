(()=>{"use strict";class e{constructor(e,t,s,n){this._name=e.name,this._link=e.link,this._likes=e.likes.length,this._alternative=e.alternative,this._templateSelectors=t,this._handleCardClick=s,this._owner=e.owner._id,this._clientId=n}generateCard(){return this._element=this._clientId===this._owner?this._getTemplate(this._templateSelectors.owner):this._getTemplate(this._templateSelectors.anoser),this._cardImage=this._element.querySelector(".places__image"),this._cardImage.src=this._link,this._cardImage.alt=this._alternative,this._element.querySelector(".places__depiction").textContent=this._name,this._element.querySelector(".places__like-calculator").textContent=this._likes,this._setEventListeners(),this._element}_getTemplate(e){return document.querySelector(e).content.querySelector(".places__place").cloneNode(!0)}_toggleLike(e){e.target.classList.toggle("places__heart_active")}_deleteCard(e){e.remove()}_setEventListeners(){this._element.querySelector(".places__heart").addEventListener("click",this._toggleLike),this._cardImage.addEventListener("click",(()=>{this._handleCardClick(this._name,this._link)}))}}class t{constructor(e,t){this._config=e,this._form=t,this._inputList=Array.from(this._form.querySelectorAll(this._config.inputSelector)),this._buttonElement=this._form.querySelector(this._config.submitButtonSelector)}_hideInputError(e){this._errorElement=this._form.querySelector(`.${e.id}-error`),e.classList.remove(this._config.inputErrorClass),this._errorElement.classList.remove(this._config.errorClass),this._errorElement.textContent=""}_showInputError(e){this._errorElement=this._form.querySelector(`.${e.id}-error`),e.classList.add(this._config.inputErrorClass),this._errorElement.textContent=e.validationMessage,this._errorElement.classList.add(this._config.errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_disableSubmitButton(){this._buttonElement.classList.add(this._config.inactiveButtonClass),this._buttonElement.disabled=!0}_enableSubmitButton(){this._buttonElement.classList.remove(this._config.inactiveButtonClass),this._buttonElement.disabled=!1}_toggleButtonState(){this._hasInvalidInput()?this._disableSubmitButton():this._enableSubmitButton()}_setEventListeners(){this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}resetValidation(){this._toggleButtonState(),this._inputList.forEach((e=>{this._hideInputError(e)}))}enableValidation(){this._setEventListeners()}}class s{constructor(e){this._popup=document.querySelector(e)}open(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popup.addEventListener("mousedown",(e=>{e.target.classList.contains("popup_opened")&&this.close(),e.target.classList.contains("popup__close-button")&&this.close()}))}}class n extends s{constructor(e,t){super(e),this._handlerFormSubmit=t,this._popupForm=this._popup.querySelector(".popup__form"),this._inputList=this._popupForm.querySelectorAll(".popup__input")}close(){super.close(),this._popupForm.reset()}setInputValues(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}_getInputValues(){return this._formData={},this._inputList.forEach((e=>{this._formData[e.name]=e.value})),this._formData}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handlerFormSubmit(this._getInputValues()),this.close()}))}}const r=document.querySelector(".places"),o={owner:"#template-place-owner",anoser:"#template-place"},i=document.querySelector(".profile__edit-button"),a=(document.querySelector("#popup__profile-setting").querySelector("#profile-setting_close-button"),document.querySelector(".popup__input_name"),document.querySelector(".profile__name")),l=(document.querySelector(".popup__input_description"),document.querySelector(".profile__description")),p=document.querySelector(".profile__image"),u=document.querySelector(".profile__add-button");document.querySelector("#popup__cards-setting").querySelector("#cards-setting_close-button"),document.querySelector(".popup__input_title"),document.querySelector(".popup__input_url"),document.querySelector(".popup-image");const c=new class{constructor(e){this.url=e.url,this.headers=e.headers}_handleResponseStatus(e){return e.ok?e.json():Promise.reject(`Произошла ошибка: ${e.status}`)}getUserInformation(){return fetch(`${this.url}/users/me`,{method:"GET",headers:{authorization:this.headers,"Content-Type":"application/json"}}).then((e=>this._handleResponseStatus(e)))}getInitialCards(){return fetch(`${this.url}/cards`,{method:"GET",headers:{authorization:this.headers,"Content-Type":"application/json"}}).then((e=>this._handleResponseStatus(e)))}updateUserInformation(e){return fetch(`${this.url}/users/me`,{method:"PATCH",headers:{authorization:this.headers,"Content-Type":"application/json"},body:JSON.stringify({name:e.name,about:e.about})}).then((e=>this._handleResponseStatus(e)))}handleAddCard(e){return fetch(`${this.url}/cards`,{method:"POST",headers:{authorization:this.headers,"Content-Type":"application/json"},body:JSON.stringify({name:e.name,link:e.link})}).then((e=>this._handleResponseStatus(e)))}}({url:"https://mesto.nomoreparties.co/v1/cohort-60",headers:"50c7d53e-b526-44ca-b3ac-53bfa1ff2f46"}),_={},h=new class{constructor(e,t,s){this._name=e,this._description=t,this._avatarInput=s}getUserInfo(){return this._userInfo={},this._userInfo.name=this._name.textContent,this._userInfo.about=this._description.textContent,this._userInfo}setUserInfo(e){this._name.textContent=e.name,this._description.textContent=e.about,this._avatarInput.src=e.avatar}setUserAvatar(e){this._avatarInput.src=e.avatarImput}}(a,l,p);function d(e,t){f.open({name:e,link:t})}var m;m={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},Array.from(document.querySelectorAll(m.formSelector)).forEach((e=>{const s=new t(m,e),n=e.getAttribute("name");_[n]=s,s.enableValidation()}));const f=new class extends s{constructor(e){super(e),this._popupImage=this._popup.querySelector(".popup-image__image"),this._captionPopupImage=this._popup.querySelector(".popup-image__caption")}open(e){super.open(),this._captionPopupImage.textContent=e.name,this._popupImage.src=e.link,this._popupImage.alt=`Изображение ${e.name}`}}(".popup-image");f.setEventListeners();const g=new class{constructor(e,t){this._container=t,this._renderer=e}renderItems(e){e.reverse().forEach((e=>{this._renderer(e,this._container)}))}renderItem(e){this._renderer(e,this._container)}}((function(e,t){t.prepend(e)}),r);function S(t,s){return new e(t,o,d,s).generateCard()}const v=new n("#popup__cards-setting",(function(e){c.handleAddCard(e).then((e=>g.renderItem(S(e)))).catch((e=>console.log(e)))}));v.setEventListeners();const E=new n("#popup__profile-setting",(function(e){c.updateUserInformation(e).then((e=>{h.setUserInfo(e)})).catch((e=>console.log(e)))}));E.setEventListeners(),Promise.all([c.getUserInformation(),c.getInitialCards()]).then((e=>{const t=e[0],s=e[1];h.setUserInfo(t),p.src=t.avatar,h.id=t._id;const n=s.map((e=>S(e,h.id)));g.renderItems(n)})).catch((e=>console.log(e))),i.addEventListener("click",(function(){E.open(),E.setInputValues(h.getUserInfo()),_["profile-setup-form"].resetValidation()})),u.addEventListener("click",(function(){v.open(),_["cards-setting-form"].resetValidation()}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TUFBTVYsSUFDTCxNQUFNYSxFQUFXYixFQUFJLEdBQ2Y0RCxFQUFlNUQsRUFBSSxHQUV6QnFCLEVBQU9RLFlBQVloQixHQUNuQm5CLEVBQVk5RSxJQUFNaUcsRUFBU2lCLE9BQzNCVCxFQUFPekUsR0FBS2lFLEVBQVN6RyxJQUVyQixNQUFNeUosRUFBa0JELEVBQWFFLEtBQUs1SyxHQUNqQ2tLLEVBQVdsSyxFQUFNbUksRUFBT3pFLE1BR2pDK0YsRUFBUUssWUFBWWEsRUFBZ0IsSUFFckNQLE9BQU9DLEdBQVFDLFFBQVFDLElBQUlGLEtBSTlCaEUsRUFBYzNELGlCQUFpQixTQUFTLFdBRXRDOEgsRUFBb0J4RixPQUNwQndGLEVBQW9CM0UsZUFBZXNDLEVBQU9NLGVBQzFDUCxFQUFlLHNCQUFzQnZELGlCQUN2QyxJQUVBOEIsRUFBZS9ELGlCQUFpQixTQUFTLFdBRXZDeUgsRUFBVW5GLE9BQ1ZrRCxFQUFlLHNCQUFzQnZELGlCQUN2QyxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3IoZGF0YSwgdGVtcGxhdGVTZWxlY3RvcnMsIGhhbmRsZUNhcmRDbGljaywgY2xpZW50SWQpIHtcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XG4gICAgdGhpcy5fbGlrZXMgPSBkYXRhLmxpa2VzLmxlbmd0aDtcbiAgICB0aGlzLl9hbHRlcm5hdGl2ZSA9IGRhdGEuYWx0ZXJuYXRpdmU7XG4gICAgdGhpcy5fdGVtcGxhdGVTZWxlY3RvcnMgPSB0ZW1wbGF0ZVNlbGVjdG9ycztcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XG4gICAgdGhpcy5fb3duZXIgPSBkYXRhLm93bmVyLl9pZDtcbiAgICB0aGlzLl9jbGllbnRJZCA9IGNsaWVudElkO1xuICB9XG5cbiAgZ2VuZXJhdGVDYXJkKCkge1xuICAgIC8v0L/RgNC+0LLQtdGA0Y/QtdC8INC+0LHQu9Cw0LTQsNGC0LXQu9GPID0+INCx0LXRgNC10Lwg0YLQtdC80L/Qu9C10LnRglxuICAgIHRoaXMuX2VsZW1lbnQgPVxuICAgICAgdGhpcy5fY2xpZW50SWQgPT09IHRoaXMuX293bmVyXG4gICAgICAgID8gdGhpcy5fZ2V0VGVtcGxhdGUodGhpcy5fdGVtcGxhdGVTZWxlY3RvcnMub3duZXIpXG4gICAgICAgIDogdGhpcy5fZ2V0VGVtcGxhdGUodGhpcy5fdGVtcGxhdGVTZWxlY3RvcnMuYW5vc2VyKTtcblxuICAgIHRoaXMuX2NhcmRJbWFnZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wbGFjZXNfX2ltYWdlXCIpO1xuICAgIHRoaXMuX2NhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xuICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSB0aGlzLl9hbHRlcm5hdGl2ZTtcbiAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGxhY2VzX19kZXBpY3Rpb25cIikudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wbGFjZXNfX2xpa2UtY2FsY3VsYXRvclwiKS50ZXh0Q29udGVudCA9XG4gICAgICB0aGlzLl9saWtlcztcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xuICB9XG5cbiAgX2dldFRlbXBsYXRlKHRlbXBsYXRlKSB7XG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGVtcGxhdGUpXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLnBsYWNlc19fcGxhY2VcIilcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG5cbiAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XG4gIH1cblxuICBfdG9nZ2xlTGlrZShldnQpIHtcbiAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC50b2dnbGUoXCJwbGFjZXNfX2hlYXJ0X2FjdGl2ZVwiKTtcbiAgfVxuXG4gIF9kZWxldGVDYXJkKGVsZW1lbnQpIHtcbiAgICBlbGVtZW50LnJlbW92ZSgpO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2VsZW1lbnQgLy8g0KHRgtCw0LLQuNC8INC70LDQudC6XG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5wbGFjZXNfX2hlYXJ0XCIpXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX3RvZ2dsZUxpa2UpO1xuXG4gICAgLyp0aGlzLl9lbGVtZW50IC8vINCj0LTQsNC70Y/QtdC8INC60LDRgNGC0L7Rh9C60YNcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLnBsYWNlc19fZGVsZXRlLWljb25cIilcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9kZWxldGVDYXJkKHRoaXMuX2VsZW1lbnQpO1xuICAgICAgfSk7Ki9cblxuICAgIHRoaXMuX2NhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKHRoaXMuX25hbWUsIHRoaXMuX2xpbmspO1xuICAgIH0pO1xuICB9XG59XG5cbmV4cG9ydCB7IENhcmQgfTtcbiIsImNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3Rvcihjb25maWcsIGZvcm0pIHtcbiAgICB0aGlzLl9jb25maWcgPSBjb25maWc7XG4gICAgdGhpcy5fZm9ybSA9IGZvcm07XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcbiAgICAgIHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9jb25maWcuaW5wdXRTZWxlY3RvcikgLy/Qn9C+0LvRg9GH0LDQtdC8INC40L3Qv9GD0YLRi1xuICAgICk7XG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcbiAgICAgIHRoaXMuX2NvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3RvclxuICAgICk7XG4gIH1cblxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XG4gICAgdGhpcy5fZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XG4gICAgdGhpcy5fZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fY29uZmlnLmVycm9yQ2xhc3MpO1xuICAgIHRoaXMuX2Vycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG4gIH1cblxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XG4gICAgdGhpcy5fZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XG4gICAgdGhpcy5fZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xuICAgIHRoaXMuX2Vycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2NvbmZpZy5lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XG4gICAgaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkXG4gICAgICA/IHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudClcbiAgICAgIDogdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgfVxuXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+ICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpO1xuICB9XG5cbiAgX2Rpc2FibGVTdWJtaXRCdXR0b24oKSB7XG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2NvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTsgLy8g0KLQuNC/INC60L3QvtC/0LrQuCjRgdC+0YXRgNCw0L3QuNGPINC/0L7Qv9Cw0L/QsCkg0LLRi9C60LvRjtGH0LXQvdC90LBcbiAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcbiAgfVxuXG4gIF9lbmFibGVTdWJtaXRCdXR0b24oKSB7XG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2NvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XG4gIH1cblxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgdGhpcy5faGFzSW52YWxpZElucHV0KClcbiAgICAgID8gdGhpcy5fZGlzYWJsZVN1Ym1pdEJ1dHRvbigpXG4gICAgICA6IHRoaXMuX2VuYWJsZVN1Ym1pdEJ1dHRvbigpO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9KTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxufVxuXG5leHBvcnQgeyBGb3JtVmFsaWRhdG9yIH07XG4iLCJjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gIH1cbiAgb3BlbigpIHtcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfb3BlbmVkXCIpOyAvLyDQvtGC0LrRgNGL0YLRjCDQv9C+0L/QsNC/XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX29wZW5lZFwiKTsgLy8g0JfQsNC60YDRi9GC0Ywg0L/QvtC/0LDQv1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfTtcblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldnQpID0+IHtcbiAgICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInBvcHVwX29wZW5lZFwiKSkge1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICB9XG4gICAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cF9fY2xvc2UtYnV0dG9uXCIpKSB7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuZXhwb3J0IHsgUG9wdXAgfTtcbiIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlckZvcm1TdWJtaXQpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9oYW5kbGVyRm9ybVN1Ym1pdCA9IGhhbmRsZXJGb3JtU3VibWl0O1xuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1cIik7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIucG9wdXBfX2lucHV0XCIpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcbiAgfVxuXG4gIHNldElucHV0VmFsdWVzKGRhdGEpIHtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIC8vINGC0YPRgiDQstGB0YLQsNCy0LvRj9C10Lwg0LIgYHZhbHVlYCDQuNC90L/Rg9GC0LAg0LTQsNC90L3Ri9C1INC40Lcg0L7QsdGK0LXQutGC0LAg0L/QviDQsNGC0YDQuNCx0YPRgtGDIGBuYW1lYCDRjdGC0L7Qs9C+INC40L3Qv9GD0YLQsFxuICAgICAgaW5wdXQudmFsdWUgPSBkYXRhW2lucHV0Lm5hbWVdO1xuICAgIH0pO1xuICB9XG5cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIHRoaXMuX2Zvcm1EYXRhID0ge307XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICB0aGlzLl9mb3JtRGF0YVtpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiB0aGlzLl9mb3JtRGF0YTtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2ZW50KSA9PiB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlckZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfSk7XG4gIH1cbn1cblxuZXhwb3J0IHsgUG9wdXBXaXRoRm9ybSB9O1xuIiwiY29uc3QgdmFsaWRhdGlvbkNvbmZpZyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5wb3B1cF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5wb3B1cF9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLnBvcHVwX19idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJwb3B1cF9fYnV0dG9uX2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJwb3B1cF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcInBvcHVwX19lcnJvcl92aXNpYmxlXCIsXG59O1xuXG4vKiDQodCV0JrQptCY0K8g0KLQldCc0J/Qm9CV0JnQoiAo0JrQkNCg0KLQntCn0JrQmCkgKi9cbmNvbnN0IHBsYWNlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGxhY2VzXCIpOyAvLyDQsdC70L7QuiDQsiBodG1sINC00LvRjyDQutCw0YDRgtC+0YfQutC4XG5jb25zdCB0ZW1wbGF0ZVNlbGVjdG9ycyA9IHtcbiAgb3duZXI6IFwiI3RlbXBsYXRlLXBsYWNlLW93bmVyXCIsXG4gIGFub3NlcjogXCIjdGVtcGxhdGUtcGxhY2VcIixcbn07XG5cbi8qINCf0J7Qn9CQ0J8g0KDQldCU0JDQmtCi0JjQoNCe0JLQkNCd0JjQlSDQn9Cg0J7QpNCY0JvQryAqL1xuY29uc3QgcHJvZmlsZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIik7IC8vINC60L3QvtC/0LrQsCDRgNC10LTQsNC60YLQuNGA0L7QstCw0L3QuNC1INC/0YDQvtGE0LjQu9GB0Y9cbmNvbnN0IHBvcHVwUHJvZmlsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcG9wdXBfX3Byb2ZpbGUtc2V0dGluZ1wiKTsgLy8g0YHQtdC60YbQuNGPINC/0L7Qv9Cw0L9cbmNvbnN0IGNsb3NlQnV0dG9uUG9wdXBQcm9maWxlID0gcG9wdXBQcm9maWxlLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI3Byb2ZpbGUtc2V0dGluZ19jbG9zZS1idXR0b25cIlxuKTsgLy8g0LrQvdC+0L/QutCwINC30LDQutGA0YvRgtC40Y8g0L/QvtC/0LDQv1xuLy9jb25zdCBmb3JtRWxQcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLXNldHRpbmdfX2Zvcm1cIik7IC8v0YTQvtGA0LzQsCDQuNC90L/Rg9GC0L7QslxuY29uc3QgbmFtZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW5wdXRfbmFtZVwiKTsgLy8g0LjQvdC/0YPRgiDRgSDQuNC80LXQvdC10LxcbmNvbnN0IHByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uYW1lXCIpOyAvLyDQuNC80Y8g0L/RgNC+0YTQuNC70Y9cbmNvbnN0IGRlc2NyaXB0aW9uSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbnB1dF9kZXNjcmlwdGlvblwiKTsgLy8g0LjQvdC/0YPRgiDRgSDQvtC/0LjRgdCw0L3QuNC10LxcbmNvbnN0IGRlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKTsgLy8g0L7Qv9C40YHQsNC90LjQtSDQv9GA0L7RhNC40LvRgdGPXG5jb25zdCBhdmF0YXJJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW1hZ2VcIik7XG4vKiDQoNCV0JTQkNCa0KLQmNCg0J7QktCQ0J3QmNCVINCf0KDQntCk0JjQm9CvICovXG5cbi8qINCf0J7Qn9CQ0J8g0JTQntCR0JDQktCb0JXQndCY0K8g0JrQkNCg0KLQntCn0JrQmCAqL1xuY29uc3QgY2FyZHNBZGRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7IC8vINC60L3QvtC/0LrQsCDRgNC10LTQsNC60YLQuNGA0L7QstCw0L3QuNC1INC60LDRgNGC0L7Rh9C10LpcbmNvbnN0IHBvcHVwQ2FyZHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BvcHVwX19jYXJkcy1zZXR0aW5nXCIpOyAvLyDRgdC10LrRhtC40Y8g0L/QvtC/0LDQvyDRgSDQutCw0YDRgtC+0YfQutCw0LzQuFxuY29uc3QgY2xvc2VCdXR0b25DYXJkcyA9IHBvcHVwQ2FyZHMucXVlcnlTZWxlY3RvcihcbiAgXCIjY2FyZHMtc2V0dGluZ19jbG9zZS1idXR0b25cIlxuKTsgLy8g0LrQvdC+0L/QutCwINC30LDQutGA0YvRgtC40Y8g0L/QvtC/0LDQv1xuLy9jb25zdCBmb3JtRWxDYXJkcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZHMtc2V0dGluZ19fZm9ybVwiKTsgLy/RhNC+0YDQvNCwINC40L3Qv9GD0YLQvtCyXG5jb25zdCB0aXRsZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW5wdXRfdGl0bGVcIik7IC8vINC40L3Qv9GD0YIg0YEg0L3QsNC30LLQsNC90LjQtdC8XG5jb25zdCB1cmxJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2lucHV0X3VybFwiKTsgLy8g0LjQvdC/0YPRgiDRgSDRgdGB0YvQu9C60L7QuVxuLyog0J/QntCf0JDQnyDQlNCe0JHQkNCS0JvQldCd0JjQryDQmtCQ0KDQotCe0KfQmtCYICovXG5cbmNvbnN0IGFwaUNvbmZpZyA9IHtcbiAgdXJsOiBcImh0dHBzOi8vbWVzdG8ubm9tb3JlcGFydGllcy5jby92MS9jb2hvcnQtNjBcIixcbiAgaGVhZGVyczogXCI1MGM3ZDUzZS1iNTI2LTQ0Y2EtYjNhYy01M2JmYTFmZjJmNDZcIixcbn07XG5cbi8qINCf0J7Qn9CQ0J8g0J/QoNCe0KHQnNCe0KLQoNCQINCa0JDQoNCi0J7Qp9Ca0JggKi9cbmNvbnN0IHBvcHVwSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwLWltYWdlXCIpOyAvLyDQv9C+0L/QsNC/INGBINC60LDRgNGC0LjQvdC60L7QuVxuXG5leHBvcnQge1xuICB0ZW1wbGF0ZVNlbGVjdG9ycyxcbiAgdmFsaWRhdGlvbkNvbmZpZyxcbiAgcGxhY2VzLFxuICBwcm9maWxlQnV0dG9uLFxuICBwb3B1cFByb2ZpbGUsXG4gIG5hbWVJbnB1dCxcbiAgcHJvZmlsZU5hbWUsXG4gIGRlc2NyaXB0aW9uSW5wdXQsXG4gIGRlc2NyaXB0aW9uLFxuICBjYXJkc0FkZEJ1dHRvbixcbiAgcG9wdXBDYXJkcyxcbiAgdGl0bGVJbnB1dCxcbiAgdXJsSW5wdXQsXG4gIHBvcHVwSW1hZ2UsXG4gIGNsb3NlQnV0dG9uUG9wdXBQcm9maWxlLFxuICBjbG9zZUJ1dHRvbkNhcmRzLFxuICBhcGlDb25maWcsXG4gIGF2YXRhckltYWdlLFxufTtcbiIsImltcG9ydCB7IENhcmQgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgeyBGb3JtVmFsaWRhdG9yIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IHsgU2VjdGlvbiB9IGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcbmltcG9ydCB7IFBvcHVwV2l0aEltYWdlIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCB7IFBvcHVwV2l0aEZvcm0gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XG5pbXBvcnQgeyBVc2VySW5mbyB9IGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5pbXBvcnQge1xuICB0ZW1wbGF0ZVNlbGVjdG9ycyxcbiAgdmFsaWRhdGlvbkNvbmZpZyxcbiAgcGxhY2VzLFxuICBwcm9maWxlQnV0dG9uLFxuICBuYW1lSW5wdXQsXG4gIHByb2ZpbGVOYW1lLFxuICBkZXNjcmlwdGlvbklucHV0LFxuICBkZXNjcmlwdGlvbixcbiAgY2FyZHNBZGRCdXR0b24sXG4gIHRpdGxlSW5wdXQsXG4gIHVybElucHV0LFxuICBhcGlDb25maWcsXG4gIGF2YXRhckltYWdlLFxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcblxuLy8g0JrQu9Cw0YHRgSBBcGlcbmNvbnN0IGFwaSA9IG5ldyBBcGkoYXBpQ29uZmlnKTtcblxuLy8g0KTQvtGA0LzRiyDQstCw0LvQuNC00LDRhtC40LhcbmNvbnN0IGZvcm1WYWxpZGF0b3JzID0ge307XG5cbi8vINC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRjFxuY29uc3QgY2xpZW50ID0gbmV3IFVzZXJJbmZvKHByb2ZpbGVOYW1lLCBkZXNjcmlwdGlvbiwgYXZhdGFySW1hZ2UpO1xuXG4vLyDQvtGC0LrRgNGL0YLRjCDQv9C+0L/QsNC/INGBINC60LDRgNGC0LjQvdC60L7QuVxuXG5mdW5jdGlvbiBoYW5kbGVDYXJkQ2xpY2sobmFtZSwgbGluaykge1xuICBwb3B1cFdpdGhJbWFnZS5vcGVuKHsgbmFtZSwgbGluayB9KTtcbn1cblxuLy8g0JLQutC70Y7Rh9C10L3QuNC1INCy0LDQu9C40LTQsNGG0LjQuFxuY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9IChjb25maWcpID0+IHtcbiAgY29uc3QgZm9ybUxpc3QgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmZvcm1TZWxlY3RvcikpO1xuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xuICAgIGNvbnN0IHZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgZm9ybUVsZW1lbnQpO1xuICAgIGNvbnN0IGZvcm1OYW1lID0gZm9ybUVsZW1lbnQuZ2V0QXR0cmlidXRlKFwibmFtZVwiKTtcbiAgICBmb3JtVmFsaWRhdG9yc1tmb3JtTmFtZV0gPSB2YWxpZGF0b3I7XG4gICAgdmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbiAgfSk7XG59O1xuZW5hYmxlVmFsaWRhdGlvbih2YWxpZGF0aW9uQ29uZmlnKTtcblxuLy8g0JrQu9Cw0YHRgSBwb3B1cFdpdGhJbWFnZSAgPT5cbmNvbnN0IHBvcHVwV2l0aEltYWdlID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiLnBvcHVwLWltYWdlXCIpO1xucG9wdXBXaXRoSW1hZ2Uuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy/RhNGD0L3QutGG0LjRjyDQtNC70Y8gU2VjdGlvblxuZnVuY3Rpb24gcmVuZGVyZXIoZWxlbWVudCwgY29udGFpbmVyKSB7XG4gIGNvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xufVxuXG4vLyDQmtC70LDRgdGBIFNlY3Rpb24gID0+XG5jb25zdCBzZWN0aW9uID0gbmV3IFNlY3Rpb24ocmVuZGVyZXIsIHBsYWNlcyk7XG5cbmZ1bmN0aW9uIGhhbmRsZUNhbGxiYWNrQ2FyZChjYXJkKSB7XG4gIGFwaVxuICAgIC5oYW5kbGVBZGRDYXJkKGNhcmQpXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgIHJldHVybiBzZWN0aW9uLnJlbmRlckl0ZW0oY3JlYXRlQ2FyZChkYXRhKSk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XG59XG5cbi8vINGB0L7Qt9C00LDRkdC8INC60LDRgNGC0L7Rh9C60YNcbmZ1bmN0aW9uIGNyZWF0ZUNhcmQob2JqZWN0LCBjbGllbnRJZCkge1xuICAvL2NvbnNvbGUubG9nKHVzZXJJbmZvKTtcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxuICAgIG9iamVjdCxcbiAgICB0ZW1wbGF0ZVNlbGVjdG9ycyxcbiAgICBoYW5kbGVDYXJkQ2xpY2ssXG4gICAgY2xpZW50SWRcbiAgKTtcbiAgcmV0dXJuIGNhcmQuZ2VuZXJhdGVDYXJkKCk7XG59XG5cbi8vINCa0LvQsNGB0YEg0L/QvtC/0LDQvyDQutCw0YDRgtC+0YfQutC4ID0+XG5jb25zdCBwb3B1cENhcmQgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgXCIjcG9wdXBfX2NhcmRzLXNldHRpbmdcIixcbiAgaGFuZGxlQ2FsbGJhY2tDYXJkXG4pO1xucG9wdXBDYXJkLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8vINCa0LvQsNGB0YEg0L/QvtC/0LDQvyDQv9GA0L7RhNC40LvRjywg0Y7Qt9C10YDQsCA9PlxuXG5mdW5jdGlvbiBoYW5kbGVDYWxsYmFjbFByb2ZpbGUob2JqZWN0KSB7XG4gIGFwaVxuICAgIC51cGRhdGVVc2VySW5mb3JtYXRpb24ob2JqZWN0KVxuICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICBjbGllbnQuc2V0VXNlckluZm8oZGF0YSk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XG59XG5cbi8vINC60LvQsNGB0YEg0L/QvtC/0LDQvyDQv9GA0L7RhNC40LvRjyA9PlxuY29uc3QgcG9wdXBQcm9maWxlU2V0dGluZyA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIiNwb3B1cF9fcHJvZmlsZS1zZXR0aW5nXCIsXG4gIGhhbmRsZUNhbGxiYWNsUHJvZmlsZVxuKTtcbnBvcHVwUHJvZmlsZVNldHRpbmcuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4vL9C00LDQvdC90YvQtSDQv9GA0L7RhNC40LvRjyAsINC60LDRgNGC0L7Rh9C60LhcblByb21pc2UuYWxsKFthcGkuZ2V0VXNlckluZm9ybWF0aW9uKCksIGFwaS5nZXRJbml0aWFsQ2FyZHMoKV0pXG4gIC50aGVuKChyZXMpID0+IHtcbiAgICBjb25zdCB1c2VySW5mbyA9IHJlc1swXTtcbiAgICBjb25zdCBpbml0aWFsQ2FyZHMgPSByZXNbMV07XG5cbiAgICBjbGllbnQuc2V0VXNlckluZm8odXNlckluZm8pO1xuICAgIGF2YXRhckltYWdlLnNyYyA9IHVzZXJJbmZvLmF2YXRhcjtcbiAgICBjbGllbnQuaWQgPSB1c2VySW5mby5faWQ7XG5cbiAgICBjb25zdCBkZWZhdWx0Q2FyZExpc3QgPSBpbml0aWFsQ2FyZHMubWFwKChkYXRhKSA9PiB7XG4gICAgICByZXR1cm4gY3JlYXRlQ2FyZChkYXRhLCBjbGllbnQuaWQpO1xuICAgIH0pO1xuXG4gICAgc2VjdGlvbi5yZW5kZXJJdGVtcyhkZWZhdWx0Q2FyZExpc3QpO1xuICB9KVxuICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XG5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG5wcm9maWxlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gIC8vINC+0YLQutGA0YvRgtC40LUg0L/QvtC/0LDQv9CwINC/0L4g0L3QsNC20LDRgtC40Y4g0L3QsCDQutC90L7Qv9C60YMg0L/RgNC+0YTQuNC70Y9cbiAgcG9wdXBQcm9maWxlU2V0dGluZy5vcGVuKCk7XG4gIHBvcHVwUHJvZmlsZVNldHRpbmcuc2V0SW5wdXRWYWx1ZXMoY2xpZW50LmdldFVzZXJJbmZvKCkpO1xuICBmb3JtVmFsaWRhdG9yc1tcInByb2ZpbGUtc2V0dXAtZm9ybVwiXS5yZXNldFZhbGlkYXRpb24oKTtcbn0pO1xuXG5jYXJkc0FkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xuICAvL9C+0YLQutGA0YvRgtC40LUg0L/QvtC/0LDQv9CwINC/0L4g0L3QsNC20LDRgtC40Y4g0L3QsCDQutC90L7Qv9C60YMg0LTQvtCx0LDQstC70LXQvdC40LUg0LrQsNGA0YLQvtGH0LrQuFxuICBwb3B1cENhcmQub3BlbigpO1xuICBmb3JtVmFsaWRhdG9yc1tcImNhcmRzLXNldHRpbmctZm9ybVwiXS5yZXNldFZhbGlkYXRpb24oKTtcbn0pO1xuXG4vKlxuXG5jb25zdCBwb3B1cENhcmQgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNwb3B1cF9fY2FyZHMtc2V0dGluZ1wiLCAob2JqZWN0KSA9PiB7XG4gIGRlZmF1bHRDYXJkTGlzdC5hZGRJdGVtKGNyZWF0ZUNhcmQob2JqZWN0KSk7XG59KTtcbnBvcHVwQ2FyZC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5hcGlcbiAgLmdldFVzZXJJbmZvcm1hdGlvbigpXG4gIC50aGVuKChJbmZvKSA9PiB7XG4gICAgY29uc29sZS5sb2coSW5mbylcbiAgICByZXR1cm4gdXNlckluZm8uc2V0VXNlckluZm8oSW5mbyk7XG4gIH0pXG4gIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKTtcblxuXG5cbi8v0LTQsNC90L3Ri9C1INC/0YDQvtGE0LjQu9GPINC90LAg0YHQtdGA0LLQtdGAXG5hcGkuZ2V0SW5pdGlhbENhcmRzKCkudGhlbigob2JqZWN0KSA9PiB7XG4gIGNvbnN0IGRlZmF1bHRDYXJkTGlzdCA9IG9iamVjdC5tYXAoKGRhdGEpID0+IHtcbiAgICByZXR1cm4gY3JlYXRlQ2FyZChkYXRhKTtcbiAgfSk7XG4gIHNlY3Rpb24ucmVuZGVySXRlbXMoZGVmYXVsdENhcmRMaXN0KTtcbn0pO1xuXG5cbmFwaS51cGRhdGVVc2VySW5mb3JtYXRpb24ob2JqZWN0KVxuICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhkYXRhKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKTtcblxuXG5cblxuXG5hcGkudXBkYXRlVXNlckluZm9ybWF0aW9uKCkudGhlbigoaW5mbykgPT4ge1xuICBjb25zb2xlLmxvZyhpbmZvKVxufSkgIFxuXG5yZXR1cm4gZmV0Y2goXCJodHRwczovL21lc3RvLm5vbW9yZXBhcnRpZXMuY28vdjEvY29ob3J0LTYwL2NhcmRzXCIsIHtcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgYXV0aG9yaXphdGlvbjogXCI1MGM3ZDUzZS1iNTI2LTQ0Y2EtYjNhYy01M2JmYTFmZjJmNDZcIixcblxuY29uc3QgcG9wdXBQcm9maWxlU2V0dGluZyA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIiNwb3B1cF9fcHJvZmlsZS1zZXR0aW5nXCIsXG4gIChvYmplY3QpID0+IHtcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyhvYmplY3QpO1xuICB9XG4pO1xuXG4qL1xuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgYXBpIHtcclxuICBjb25zdHJ1Y3Rvcihjb25maWcpIHtcclxuICAgIHRoaXMudXJsID0gY29uZmlnLnVybDtcclxuICAgIHRoaXMuaGVhZGVycyA9IGNvbmZpZy5oZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZVJlc3BvbnNlU3RhdHVzKHJlcykge1xyXG4gICAgcmV0dXJuIHJlcy5va1xyXG4gICAgICA/IHJlcy5qc29uKClcclxuICAgICAgOiBQcm9taXNlLnJlamVjdChg0J/RgNC+0LjQt9C+0YjQu9CwINC+0YjQuNCx0LrQsDogJHtyZXMuc3RhdHVzfWApO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm9ybWF0aW9uKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMudXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkdFVFwiLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5oZWFkZXJzLFxyXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICB9LFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9oYW5kbGVSZXNwb25zZVN0YXR1cyhyZXMpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy51cmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLmhlYWRlcnMsXHJcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgIH0sXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgcmV0dXJuIHRoaXMuX2hhbmRsZVJlc3BvbnNlU3RhdHVzKHJlcyk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZVVzZXJJbmZvcm1hdGlvbih1c2VySW5mbykge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMudXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLmhlYWRlcnMsXHJcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgIH0sXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiB1c2VySW5mby5uYW1lLFxyXG4gICAgICAgIGFib3V0OiB1c2VySW5mby5hYm91dCxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgcmV0dXJuIHRoaXMuX2hhbmRsZVJlc3BvbnNlU3RhdHVzKHJlcyk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGhhbmRsZUFkZENhcmQoY2FyZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMudXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuaGVhZGVycyxcclxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICAgICAgfSxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IGNhcmQubmFtZSxcclxuICAgICAgICBsaW5rOiBjYXJkLmxpbmssXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9oYW5kbGVSZXNwb25zZVN0YXR1cyhyZXMpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcblxyXG4vKiBcclxuXHJcblxyXG5cclxucmV0dXJuIGZldGNoKGAke3RoaXMudXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVEhcIixcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuaGVhZGVycyxcclxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICAgICAgfSxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IFwiTWFyaWUgU2vFgm9kb3dza2EgQ3VyaWVcIixcclxuICAgICAgICBhYm91dDogXCJQaHlzaWNpc3QgYW5kIENoZW1pc3RcIixcclxuICAgICAgfSksXHJcbiAgICB9KVxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KFxyXG4gICAgICBuZXcgRXJyb3IoYNCf0YDQvtC40LfQvtGI0LvQsCDQvtGI0LjQsdC60LA6ICR7cmVzLnN0YXR1c31gKVxyXG5cclxuXHJcbiovXHJcbiIsImNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IobmFtZUlucHV0LCBkZXNjcmlwdGlvbklucHV0LCBhdmF0YXJJbnB1dCkge1xuICAgIHRoaXMuX25hbWUgPSBuYW1lSW5wdXQ7XG4gICAgdGhpcy5fZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbklucHV0O1xuICAgIHRoaXMuX2F2YXRhcklucHV0ID0gYXZhdGFySW5wdXQ7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICB0aGlzLl91c2VySW5mbyA9IHt9O1xuICAgIHRoaXMuX3VzZXJJbmZvLm5hbWUgPSB0aGlzLl9uYW1lLnRleHRDb250ZW50O1xuICAgIHRoaXMuX3VzZXJJbmZvLmFib3V0ID0gdGhpcy5fZGVzY3JpcHRpb24udGV4dENvbnRlbnQ7XG4gICAgcmV0dXJuIHRoaXMuX3VzZXJJbmZvO1xuICB9XG5cbiAgc2V0VXNlckluZm8oZGF0YSkge1xuICAgIHRoaXMuX25hbWUudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG4gICAgdGhpcy5fZGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBkYXRhLmFib3V0O1xuICAgIHRoaXMuX2F2YXRhcklucHV0LnNyYyA9IGRhdGEuYXZhdGFyO1xuICB9XG5cbiAgc2V0VXNlckF2YXRhcihvYmplY3QpIHtcbiAgICB0aGlzLl9hdmF0YXJJbnB1dC5zcmMgPSBvYmplY3QuYXZhdGFySW1wdXQ7XG4gIH1cbn1cbmV4cG9ydCB7IFVzZXJJbmZvIH07XG4iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fcG9wdXBJbWFnZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXAtaW1hZ2VfX2ltYWdlXCIpOyAvL9C60LDRgNGC0LjQvdC60LAg0L/QvtC/0LDQv9CwXG4gICAgdGhpcy5fY2FwdGlvblBvcHVwSW1hZ2UgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFxuICAgICAgLy8g0J7Qv9C40YHQsNC90LjQtSDQutCw0YDRgtC40L3QutC4XG4gICAgICBcIi5wb3B1cC1pbWFnZV9fY2FwdGlvblwiXG4gICAgKTtcbiAgfVxuXG4gIG9wZW4oaW1hZ2UpIHtcbiAgICBzdXBlci5vcGVuKCk7XG4gICAgdGhpcy5fY2FwdGlvblBvcHVwSW1hZ2UudGV4dENvbnRlbnQgPSBpbWFnZS5uYW1lO1xuICAgIHRoaXMuX3BvcHVwSW1hZ2Uuc3JjID0gaW1hZ2UubGluaztcbiAgICB0aGlzLl9wb3B1cEltYWdlLmFsdCA9IGDQmNC30L7QsdGA0LDQttC10L3QuNC1ICR7aW1hZ2UubmFtZX1gO1xuICB9XG59XG5cbmV4cG9ydCB7IFBvcHVwV2l0aEltYWdlIH07XG4iLCJjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IocmVuZGVyZXIsIGNvbnRhaW5lcikge1xuICAgIHRoaXMuX2NvbnRhaW5lciA9IGNvbnRhaW5lcjtcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICB9XG5cbiAgcmVuZGVySXRlbXMob2JqZWN0KSB7XG4gICAgb2JqZWN0LnJldmVyc2UoKS5mb3JFYWNoKChlbGVtZW50KSA9PiB7XG4gICAgICB0aGlzLl9yZW5kZXJlcihlbGVtZW50LCB0aGlzLl9jb250YWluZXIpO1xuICAgIH0pO1xuICB9XG5cbiAgcmVuZGVySXRlbShlbGVtZW50KSB7XG4gICAgdGhpcy5fcmVuZGVyZXIoZWxlbWVudCwgdGhpcy5fY29udGFpbmVyKTtcbiAgfVxufVxuXG5leHBvcnQgeyBTZWN0aW9uIH07XG4iXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwiZGF0YSIsInRlbXBsYXRlU2VsZWN0b3JzIiwiaGFuZGxlQ2FyZENsaWNrIiwiY2xpZW50SWQiLCJ0aGlzIiwiX25hbWUiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2xpa2VzIiwibGlrZXMiLCJsZW5ndGgiLCJfYWx0ZXJuYXRpdmUiLCJhbHRlcm5hdGl2ZSIsIl90ZW1wbGF0ZVNlbGVjdG9ycyIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfb3duZXIiLCJvd25lciIsIl9pZCIsIl9jbGllbnRJZCIsImdlbmVyYXRlQ2FyZCIsIl9lbGVtZW50IiwiX2dldFRlbXBsYXRlIiwiYW5vc2VyIiwiX2NhcmRJbWFnZSIsInF1ZXJ5U2VsZWN0b3IiLCJzcmMiLCJhbHQiLCJ0ZXh0Q29udGVudCIsIl9zZXRFdmVudExpc3RlbmVycyIsInRlbXBsYXRlIiwiZG9jdW1lbnQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX3RvZ2dsZUxpa2UiLCJldnQiLCJ0YXJnZXQiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJfZGVsZXRlQ2FyZCIsImVsZW1lbnQiLCJyZW1vdmUiLCJhZGRFdmVudExpc3RlbmVyIiwiRm9ybVZhbGlkYXRvciIsImNvbmZpZyIsImZvcm0iLCJfY29uZmlnIiwiX2Zvcm0iLCJfaW5wdXRMaXN0IiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0U2VsZWN0b3IiLCJfYnV0dG9uRWxlbWVudCIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2hpZGVJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiX2Vycm9yRWxlbWVudCIsImlkIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9zaG93SW5wdXRFcnJvciIsImFkZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGFzSW52YWxpZElucHV0Iiwic29tZSIsIl9kaXNhYmxlU3VibWl0QnV0dG9uIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImRpc2FibGVkIiwiX2VuYWJsZVN1Ym1pdEJ1dHRvbiIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImZvckVhY2giLCJyZXNldFZhbGlkYXRpb24iLCJlbmFibGVWYWxpZGF0aW9uIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwIiwib3BlbiIsIl9oYW5kbGVFc2NDbG9zZSIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwiY29udGFpbnMiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlckZvcm1TdWJtaXQiLCJzdXBlciIsIl9oYW5kbGVyRm9ybVN1Ym1pdCIsIl9wb3B1cEZvcm0iLCJyZXNldCIsInNldElucHV0VmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsIl9nZXRJbnB1dFZhbHVlcyIsIl9mb3JtRGF0YSIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJwbGFjZXMiLCJwcm9maWxlQnV0dG9uIiwicHJvZmlsZU5hbWUiLCJkZXNjcmlwdGlvbiIsImF2YXRhckltYWdlIiwiY2FyZHNBZGRCdXR0b24iLCJhcGkiLCJ1cmwiLCJoZWFkZXJzIiwiX2hhbmRsZVJlc3BvbnNlU3RhdHVzIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImdldFVzZXJJbmZvcm1hdGlvbiIsImZldGNoIiwibWV0aG9kIiwiYXV0aG9yaXphdGlvbiIsInRoZW4iLCJnZXRJbml0aWFsQ2FyZHMiLCJ1cGRhdGVVc2VySW5mb3JtYXRpb24iLCJ1c2VySW5mbyIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWJvdXQiLCJoYW5kbGVBZGRDYXJkIiwiY2FyZCIsImZvcm1WYWxpZGF0b3JzIiwiY2xpZW50IiwibmFtZUlucHV0IiwiZGVzY3JpcHRpb25JbnB1dCIsImF2YXRhcklucHV0IiwiX2Rlc2NyaXB0aW9uIiwiX2F2YXRhcklucHV0IiwiZ2V0VXNlckluZm8iLCJfdXNlckluZm8iLCJzZXRVc2VySW5mbyIsImF2YXRhciIsInNldFVzZXJBdmF0YXIiLCJvYmplY3QiLCJhdmF0YXJJbXB1dCIsInBvcHVwV2l0aEltYWdlIiwiZm9ybVNlbGVjdG9yIiwiZm9ybUVsZW1lbnQiLCJ2YWxpZGF0b3IiLCJmb3JtTmFtZSIsImdldEF0dHJpYnV0ZSIsIl9wb3B1cEltYWdlIiwiX2NhcHRpb25Qb3B1cEltYWdlIiwiaW1hZ2UiLCJzZWN0aW9uIiwicmVuZGVyZXIiLCJjb250YWluZXIiLCJfY29udGFpbmVyIiwiX3JlbmRlcmVyIiwicmVuZGVySXRlbXMiLCJyZXZlcnNlIiwicmVuZGVySXRlbSIsInByZXBlbmQiLCJjcmVhdGVDYXJkIiwicG9wdXBDYXJkIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwibG9nIiwicG9wdXBQcm9maWxlU2V0dGluZyIsImFsbCIsImluaXRpYWxDYXJkcyIsImRlZmF1bHRDYXJkTGlzdCIsIm1hcCJdLCJzb3VyY2VSb290IjoiIn0=